!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).OTrack=t()}(this,(function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;arguments.length>n;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=c(e);if(t){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d(this,n)}}function p(e,t){return g(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(e,t)||y(e,t)||w()}function v(e){return function(e){if(Array.isArray(e))return _(e)}(e)||m(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e){if(Array.isArray(e))return e}function m(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var k=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t},b=Object.prototype.toString,T=function(e){return null!=e&&"[object Object]"==b.call(e)},S=function(e){return"[object Date]"==b.call(e)},I=function(e){return Array.isArray&&Array.isArray(e)||"[object Array]"===b.call(e)},E=function(e){return"[object Function]"==b.call(e)},O=function(e){return b.call(e).slice(8,-1)},C=function(e,t,n){e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)},A=function(e,t,n){e&&(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null)};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function U(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(e,t)||q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}var F=!0,G="info",Q={debug:0,info:10,warn:100,error:1e3};function W(e){try{return JSON.stringify(e,null,"  ")}catch(t){return ne(e)}}var V=function(e){return["string","number","boolean","undefined","null"].indexOf($(e))>-1},B=function(){function e(t){P(this,e),this.namespace="",this.isShowMills=!1,this.isShowLog=!0,this.info=this.genLog("info"),this.warn=this.genLog("warn"),this.error=this.genLog("error"),this.debug=this.genLog("debug"),t&&this.setLogConfig(t)}return U(e,[{key:"setLogConfig",value:function(e){var t=e.isShowLog,n=e.isShowMills,i=void 0!==n&&n,r=e.namespace,o=void 0===r?"":r;this.isShowLog=void 0===t||t,this.isShowMills=i,this.namespace=o}},{key:"config",get:function(){return{namespace:this.namespace,isShowMills:this.isShowMills,isShowLog:this.isShowLog}}},{key:"clone",value:function(t){return new e(D(D({},this.config),t))}},{key:"genLog",value:function(e){var t=this;return function(){var n="__otrack_debug",i=!1;try{var r;i=JSON.parse((null===(r=localStorage)||void 0===r?void 0:r.getItem(n))||"false")}catch(e){}if(i&&(F=!0),!(F&&t.isShowLog||-1!==["warn","error"].indexOf(e)))return!1;if(Q[G]>Q[e])return!1;for(var o=arguments.length,a=Array(o),s=0;o>s;s++)a[s]=arguments[s];var c=a.map((function(e,t,n){return T(e)?W(e):I(e)?e.every((function(e){return V(e)||I(e)}))?e:W(e):V(e)&&t!==n.length-1?e+"":e})),u=new Date;""!==t.namespace&&c.unshift(t.namespace),c.unshift("".concat(k(u,"yyyy-MM-dd hh:mm:ss"+(t.isShowMills?".S":""))));var l=c.filter((function(e){return""!==e}));if("object"===(void 0===console?"undefined":$(console))&&console[e])try{return console[e].call(console,l.join(", "))}catch(t){console[e](l[0])}}}}]),e}();B.disableAllLog=function(){F=!1,B.disableAllLog=function(){}},B.setLogLevel=function(e){["info","debug","error","warn"].includes(e)&&(G=e)};var K=new B,J="0123456789",z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",X="~!@#$%^*()_+-=[]{}|;:,./<>?";
/**
   * @copyright Maichong Software Ltd. 2016 http://maichong.it
   * @date 2016-01-20
   * @author Liang <liang@maichong.it>
   */function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{specials:!1,letters:!0,numbers:!0};e||(e=8),t||(t={});var n="",i="";for(!0===t?n=J+z+X:"string"==typeof t?n=t:(!1!==t.numbers&&(n+="string"==typeof t.numbers?t.numbers:J),!1!==t.letters&&(n+="string"==typeof t.letters?t.letters:z),t.specials&&(n+="string"==typeof t.specials?t.specials:X));e>0;)e--,i+=n[Math.floor(Math.random()*n.length)];return i}var Z=Y(8);function ee(e){for(var t={},n=[],i=0;e.length>i;i++){var r=e[i];t.hasOwnProperty(r)?t[r]=!0:(t[r]=!1,n.push(e[i]))}return n}function te(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={};return e.filter(Boolean).forEach((function(e){var r="function"==typeof t?t(e):t;i[e[r]]?!n&&i[e[r]].push(e):i[e[r]]=n?e:[e]})),i}function ne(e,t,n,i,r){t=void 0!==t?isNaN(+t)?6:t:6;var o=new WeakMap;return JSON.stringify(function e(t,i,a,s,c){return t&&"object"==$(t)?(c=o.has(t),o.set(t,!0),s=Array.isArray(t),c?a=r&&r(t)||null:JSON.stringify(t,(function(r,o){if(s||i>0){if(n&&(o=n(r,o)),!r)return s=Array.isArray(o),t=o;!a&&(a=s?[]:{}),a[r]=e(o,s?i:i-1)}})),void 0===a?s?[]:{}:a):t}(e,t),null,i)}function ie(e){if(null==e)return e;try{e=JSON.parse(e)}catch(e){}return e}function re(e,t,n,i){i=D({cross_subdomain:!1,domain:""},i);var r=new Date,o=0;"number"==typeof n?o=r.getTime()+24*n*60*60*1e3:S(n)&&(o=n.getTime()),r.setTime(o);var a="; expires="+r.toUTCString();0===n&&(a=""),i.cross_subdomain&&(i.domain=function(e){var t;if(!(e=e||(null===(t=location)||void 0===t?void 0:t.hostname)))return"";var n=e.split(".");if(I(n)&&n.length>=2&&!/^(\d+\.)+\d+$/.test(e))for(var i="."+n.splice(n.length-1,1);n.length>0;)if(i="."+n.splice(n.length-1,1)+i,document.cookie="otrack_jssdk_domain_test=true; path=/; domain="+i,-1!==document.cookie.indexOf("otrack_jssdk_domain_test=true")){var r=new Date;return r.setTime(r.getTime()-1e3),document.cookie="otrack_jssdk_domain_test=true; expires="+r.toUTCString()+"; path=/; domain="+i,i}return""}()),document.cookie=e+"="+t+a+"; path=/"+(i.domain?"; domain="+i.domain:"")}function oe(e){var t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function ae(e){for(var t=e+"=",n=document.cookie.split(";"),i=0,r=n.length;r>i;i++){for(var o=n[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}var se=!0;try{"undefined"!=typeof localStorage&&(localStorage.setItem("testLocal","true"),localStorage.removeItem("testLocal"))}catch(e){K.warn("localStorage不支持",e),se=!1}function ce(e,t,n){var i,r;if(e.indexOf("-queue")>0&&(e="".concat(e,"/").concat(Z)),n=void 0===n||n,null!=t)if(t=ne(t),se)try{var o;null===(o=localStorage)||void 0===o||o.setItem(e,t)}catch(e){if(["QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED","QuotaExceededError","W3CException_DOM_QUOTA_EXCEEDED_ERR"].indexOf(e.name)>-1){try{for(var a=0;a<(null===(s=localStorage)||void 0===s?void 0:s.length);a++){var s,c,u=null===(c=localStorage)||void 0===c?void 0:c.key(a);if(u&&/^obus-track_/.test(u))if(-1===u.indexOf("track-queue")&&-1===u.indexOf("request-queue")){var l;null===(l=localStorage)||void 0===l||l.removeItem(u)}else{var f,d,h=(null===(f=localStorage)||void 0===f?void 0:f.getItem(u))||[];null===(d=localStorage)||void 0===d||d.setItem(u,ne({version:Date.now(),data:h.length>100?h.slice(100-h.length):h}))}}}catch(e){}return}console.log("[OTrack] setStorage error")}else n||re(e,t,30);if(void 0===t){var p;if(se)i=null===(p=localStorage)||void 0===p?void 0:p.getItem(e);else n||(i=ae(e));return ie(i)}null===t&&(se?null===(r=localStorage)||void 0===r||r.removeItem(e):n||re(e,"",-1))}var ue=!0;try{"undefined"!=typeof sessionStorage&&(sessionStorage.setItem("testLocal","true"),sessionStorage.removeItem("testLocal"))}catch(e){K.warn("sessionStorage不支持",e),ue=!1}function le(e,t,n){var i;if(n=void 0===n||n,null!=t)if(t=ne(t),ue)try{sessionStorage.setItem(e,t)}catch(e){console.log("[OTrack] sessionStorage error")}else n||re(e,t,30);if(void 0===t)return ue?i=sessionStorage.getItem(e):n||(i=ae(e)),ie(i);null===t&&(ue?sessionStorage.removeItem(e):n||re(e,"",-1))}function fe(e){var t=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}));return e&&e>0?n.slice(0,e):n}function de(){return Math.floor((new Date).getTime()/1e3)}function he(e,t){var n={};for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)&&(n[i]=e[i]);return n}var pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ve=function(e,t,n){var i,r,o,a=null,s=0;n||(n={});var c=function(){var t;s=!1===(null===(t=n)||void 0===t?void 0:t.leading)?0:Date.now(),a=null,o=e.apply(i,r),a||(i=r=null)};return function(){for(var u,l,f=arguments.length,d=Array(f),h=0;f>h;h++)d[h]=arguments[h];var p=Date.now();s||!1!==(null===(u=n)||void 0===u?void 0:u.leading)||(s=p);var v=t-(p-s);return i=this,r=arguments,0>=v||v>t?(a&&(clearTimeout(a),a=null),s=p,o=e.apply(i,r),a||(i=r=null)):a||!1===(null===(l=n)||void 0===l?void 0:l.trailing)||(a=setTimeout(c,v)),o}};function ge(e){var t,n=null===(t=location)||void 0===t?void 0:t.search.substr(1),i={};if(n)try{n.split("&").filter(Boolean).forEach((function(e){var t=M(e.split("="),2);i[t[0]]=decodeURIComponent(t[1])}))}catch(e){}return e?i[e]||null:i}function me(e){if(!e)return null;var t=e.match(/^(https?:\/\/)([^\/]+)(.*)$/i);if(t){var n=M(t,4),i=n[1],r=n[2],o=M((n[3]||"").split("?"),2),a=o[0],s=M((o[1]||"").split("#"),2),c=s[0],u=s[1],l=(c||"").split("&").filter(Boolean),f={};return l.forEach((function(e){var t=M(e.split("="),2);f[t[0]]=decodeURIComponent(t[1])})),{schema:i,host:r,path:a,search:c,query:f,hash:u||""}}return null}function ye(e){var t={};return T(e)&&Object.keys(e).forEach((function(n){t[n]="function"==typeof e[n]?e[n]():e[n]})),t}var _e,we,ke=(_e=(new Date).getTime(),function(e){return Math.ceil((_e=(9301*_e+49297)%233280)/233280*e)}),be=function(){if("function"==typeof Uint32Array){var e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),T(e)&&e.getRandomValues){var t=new Uint32Array(1);return e.getRandomValues(t)[0]/4294967296}}return ke(1e19)/1e19},Te=(we=function(){for(var e=1*(new Date).getTime(),t=0;e==1*(new Date).getTime();)t++;return e.toString(16)+t.toString(16)},function(){var e=screen.height*screen.width;e=e&&/\d{5,}/.test(e+"")?e.toString(16):(31242*be()+"").replace(".","").slice(0,8);var t=we()+"-"+be().toString(16).replace(".","")+"-"+function(){var e,t,n=navigator.userAgent,i=[],r=0;function o(e,t){var n,r=0;for(n=0;t.length>n;n++)r|=i[n]<<8*n;return e^r}for(e=0;n.length>e;e++)t=n.charCodeAt(e),i.unshift(255&t),4>i.length||(r=o(r,i),i=[]);return i.length>0&&(r=o(r,i)),r.toString(16)}()+"-"+e+"-"+we();return t||(be()+""+be()+be()).slice(2,15)});!function(){var e=le("LIFEID");e?Z=e:le("LIFEID",Z);try{for(var t=0;t<localStorage.length;t++){var n=localStorage.key(t);if(n&&/^obus-track_/.test(n)){var i=localStorage.getItem(n),r=Date.now(),o=(i=ie(i)||{version:0}).version;o&&r-o>864e5&&localStorage.removeItem(n)}}}catch(e){}}();var Se=!0;function Ie(e){if(void 0===e)return Se;Se=e}function Ee(e,t){var n,i,r=t.method,o=void 0===r?"GET":r,a=t.data,s=void 0===a?{}:a,c=t.timeout,u=void 0===c?20:c,l=!("onLine"in(navigator||{}))||(null===(n=navigator)||void 0===n?void 0:n.onLine),f=t.success,d=t.fail;u=u||20;var h=function(n){if(void 0===t.reTryCount||0>=t.reTryCount)return"function"==typeof n&&n(!0),!0;t.success=f,t.fail=d,K.warn("retry fetch with ".concat(--t.reTryCount," count.")),Ee(e,t)},p=function(){var e=window;if(void 0!==e.XMLHttpRequest)return new e.XMLHttpRequest;if(e.ActiveXObject)try{return new e.ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){return K.error(e),null}}}(),v=Ie();if(t.withCredentials&&(p.withCredentials=t.withCredentials),o=o.toUpperCase(),null==p)return K.error("xhr object is null, exiting"),!1;if(!l)return K.warn("当前网络离线，请检查网络状态!"),t.fail&&t.fail("NOT ONLINE",404),!1;if(t.success=function(e){f&&f(e),i&&(clearTimeout(i),i=0)},t.fail=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];h((function(e){d&&d.apply(null,t)})),i&&(clearTimeout(i),i=0)},i=window.setTimeout((function(){!function(){try{T(p)&&p.abort()}catch(e){K.error(e)}i&&(clearTimeout(i),i=0,t.fail&&t.fail("TIMEOUT",408),p.onreadystatechange=null,p.onload=null,p.onerror=null)}()}),1e3*u),p.onreadystatechange=function(){try{4==p.readyState&&(p.status>=200&&300>p.status||304==p.status?t.success&&t.success(function(e){if(!e)return"";try{return JSON.parse(e)}catch(e){return{}}}(p.responseText)):t.fail&&t.fail(p.responseText,p.status),p.onreadystatechange=null,p.onload=null)}catch(e){console.error(e),p.onreadystatechange=null,p.onload=null}},"GET"===o.toUpperCase()){var g=function(e){if(e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}(s)?"?"+oe(s):"";p.open("GET",e+g,v)}else p.open("POST",e,v);if(T(t.headers))for(var m in t.headers)t.headers.hasOwnProperty(m)&&p.setRequestHeader&&p.setRequestHeader(m,t.headers[m]);if("GET"===o)return p.send(),!0;var y,_=t.headers&&(t.headers["Content-Type"]||t.headers["Content-type"])||"";if(0>_.indexOf("application/x-www-form-urlencoded"))0>_.indexOf("application/json")?p.send(s):p.send(JSON.stringify(s));else if((null===(y=navigator)||void 0===y?void 0:y.sendBeacon)&&!v){var w=new URLSearchParams;Object.keys(s).forEach((function(e){w.append(e,s[e])})),navigator.sendBeacon(e,w),t.success(s)}else p.send(oe(s))}var Oe={AT:"EU",BE:"EU",DK:"EU",FI:"EU",FR:"EU",DE:"EU",GR:"EU",IE:"EU",IT:"EU",LU:"EU",NL:"EU",PT:"EU",ES:"EU",SE:"EU",GB:"EU",HU:"EU",PL:"EU",CZ:"EU",SI:"EU",SK:"EU",EE:"EU",LT:"EU",MT:"EU",CY:"EU",RO:"EU",BG:"EU",LV:"EU",HR:"EU",NO:"EU",IS:"EU",LI:"EU",CH:"EU",TR:"EU",RS:"EU",BA:"EU",MX:"US"},Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch((e=(e||"").toUpperCase()).toUpperCase()){case"EU":case"CN":case"SG":case"IN":return e;case"SGP":case"":return"SG";case"US":return"US";default:return Oe[e]||"SG"}},Ae=function(){var e,t,n=null===(e=navigator)||void 0===e||null===(t=e.userAgent)||void 0===t?void 0:t.toLowerCase(),i=function(e){return e&&(n=(e+"").toLowerCase()),/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(n)?"tablet":/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(n)?"mobile":"desktop"};return{device:i(),detect:i,isMobile:"desktop"!==i(),userAgent:n}}();function xe(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function De(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function $e(){return window.innerWidth>window.innerHeight?"landscape":"portrait"}var Pe={ucbrowser:"UC",sogou:"Sogou","2345browser":"2345",baidu:"Baidu",liebao:"LieBao",huawei:"Huawei",360:360,heytap:"oppo",oppo:"oppo",quark:"quark",vivo:"vivo",meizu:"meizu",samsung:"samsung",realme:"realme",oneplus:"oneplus",weibo:"Weibo"},je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.match(t);return i?i[n]:"0"};var Ue=function(){var e,t,n,i;if("object"!==("undefined"==typeof __wxConfig?"undefined":$(__wxConfig))){var r=window||Object.create(null),o=(null===(e=navigator)||void 0===e||null===(t=e.userAgent)||void 0===t?void 0:t.toLowerCase())||"",a={type:"",versions:""},s={IE:r.ActiveXObject||"ActiveXObject"in r,Chrome:o.indexOf("chrome")>-1&&o.indexOf("safari")>-1,Firefox:o.indexOf("firefox")>-1,Opera:!!r.opr&&!!r.opr.addons||!!r.opera||-1!==(null===(n=navigator)||void 0===n||null===(i=n.userAgent)||void 0===i?void 0:i.indexOf("OPR/")),Safari:o.indexOf("safari")>-1&&-1==o.indexOf("chrome"),Edge:o.indexOf("edge")>-1,QQBrowser:/qqbrowser/i.test(o),WeixinBrowser:/MicroMessenger/i.test(o),QQInnerBrowser:/QQ\//i.test(o),WeiboInnerBrowser:/weibo/i.test(o)};for(var c in s)if(s[c]){var u="";if("IE"==c)u=je(o,/(msie\s|trident.*rv:)([\w.]+)/,2);else if("Chrome"==c){for(var l in navigator.mimeTypes)"application/360softmgrplugin"==navigator.mimeTypes[l].type&&(c="360");var f=RegExp("(".concat(Object.keys(Pe).join("|"),")"),"gi"),d=o.toLowerCase().match(f);d&&(c=Pe[d[0]]||"Chrome"),u=je(o,/chrome\/([\d.]+)/,1)}else"Firefox"==c?u=je(o,/firefox\/([\d.]+)/,1):"Opera"==c?u=je(o,/(?:opera|opr)\/([\d.]+)/,1):"Safari"==c?u=je(o,/version\/([\d.]+)/,1):"Edge"==c?u=je(o,/edge\/([\d.]+)/,1):"QQBrowser"==c?u=je(o,/qqbrowser\/([\d.]+)/,1):"WeixinBrowser"==c?u=je(o,/MicroMessenger\/([\d.]+)/,1):"QQInnerBrowser"==c?u=je(o,/QQ\/([\d.]+)/,1):"WeiboInnerBrowser"==c&&(u=je(o,/__weibo__([\d.]+)/,1));a.type=c,a.versions=parseInt(u,10)}return a}console.log("wx",__wxConfig,"__wxConfig")}(),Le=function(){var e,t,n,i,r,o,a,s,c,u,l,f,d=(null===(e=navigator)||void 0===e?void 0:e.userAgent)||"",h="Win32"==(null===(t=navigator)||void 0===t?void 0:t.platform)||"Windows"==(null===(n=navigator)||void 0===n?void 0:n.platform),p="Mac68K"==(null===(i=navigator)||void 0===i?void 0:i.platform)||"MacPPC"==(null===(r=navigator)||void 0===r?void 0:r.platform)||"Macintosh"==(null===(o=navigator)||void 0===o?void 0:o.platform)||"MacIntel"==(null===(a=navigator)||void 0===a?void 0:a.platform);if(p)return"Mac";if((null===(s=navigator)||void 0===s?void 0:s.platform)&&"iphone"==(null===(c=navigator)||void 0===c?void 0:c.platform.toLowerCase()))return"iPhone";if("X11"==(null===(u=navigator)||void 0===u?void 0:u.platform)&&!h&&!p)return"Unix";var v=((null===(l=navigator)||void 0===l?void 0:l.platform)+"").indexOf("Linux")>-1,g=null==d||null===(f=d.toLowerCase())||void 0===f?void 0:f.match(/android/i);if(v)return g?"Android":"Linux";if(h){if(d.indexOf("Windows NT 5.0")>-1||d.indexOf("Windows 2000")>-1)return"Win2000";if(d.indexOf("Windows NT 5.1")>-1||d.indexOf("Windows XP")>-1||d.indexOf("Windows XP")>-1)return"WinXP";if(d.indexOf("Windows NT 5.2")>-1||d.indexOf("Windows 2003")>-1)return"Win2003";if(d.indexOf("Windows NT 6.0")>-1||d.indexOf("Windows Vista")>-1)return"WinVista";if(d.indexOf("Windows NT 6.1")>-1||d.indexOf("Windows 7")>-1)return"Win7";if(d.indexOf("Windows NT 6.2")>-1||d.indexOf("Windows 8")>-1)return"Win8";if(d.indexOf("Windows NT 10.0")>-1||d.indexOf("Windows 10")>-1)return"Win10"}return"Others"}(),Re=["callback"],Me=function(){function e(t){P(this,e),this.cacheMap={},this.timeout=0,this.pendingImgs=[],this.timeout=t||3e3}return U(e,[{key:"pong",value:function(e){var t=this;if(this.cacheMap[e.key])return!1;var n=function(){t.cacheMap[e.key]&&(clearTimeout(t.cacheMap[e.key]),i.src="",delete t.cacheMap[e.key],t.pendingImgs=t.pendingImgs.filter((function(t){return t.alt!==e.key})))},i=new Image,r=e.callback||function(e,t){};i.onload=function(){r(!0,!0),n()},i.onerror=function(){r(!0,!1),n()},i.alt=e.key,this.cacheMap[e.key]=window.setTimeout((function(){r(!1,"timeout"),n()}),this.timeout),i.src=e.url+"/favicon.ico?v="+ +new Date,this.pendingImgs.push(i)}},{key:"stopLoadImgs",value:function(){this.pendingImgs.forEach((function(e){e.src=""}))}}],[{key:"racePong",value:function(t,n){var i=new e,r=t.length,o=!1,a=setTimeout((function(){o=!0,n(null)}),3e3),s=function(e,t){o||t&&(n(D(D({},e),{},{connection:t})),i.stopLoadImgs(),o=!0,clearTimeout(a)),0==--r&&(clearTimeout(a),!o&&n(null))};t.forEach((function(e){var t=R(e,Re);i.pong(D(D({},e),{},{callback:function(e,n){s(t,!!e&&n)}}))}))}}]),e}(),Ne=function(){function e(t){P(this,e);var n=ce("is_virtual_env")||"",i=M(n.split("|"),2)[1];t&&(""===n||i&&Date.now()-+i>864e6)&&this.refreshEnv()}return U(e,[{key:"isInCloud",value:function(){var e=ce("is_virtual_env");return null==e&&(e=this.isNotVirtual()?"false":"true"),"true"===e.split("|")[0]}},{key:"refreshEnv",value:function(){this.isNotVirtual()||Me.racePong([{key:"gitlab",url:"http://gitlab.os.adc.com"}],(function(e){ce("is_virtual_env","".concat(!(!e||"gitlab"!==e.key||!e.connection),"|",Date.now()))}))}},{key:"isNotVirtual",value:function(){return-1===Le.toLowerCase().indexOf("win")||1240>screen.width}}]),e}();function qe(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return We(!0===t[0],!1,t)}function He(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return We(!0===t[0],!0,t)}function Fe(e){if(Array.isArray(e)){for(var t=[],n=0;e.length>n;++n)t.push(Fe(e[n]));return t}if(Ge(e)){var i={};for(var r in e)i[r]=Fe(e[r]);return i}return e}function Ge(e){return e&&"object"===$(e)&&!Array.isArray(e)}function Qe(e,t){if(!Ge(e))return t;for(var n in t)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=Ge(e[n])&&Ge(t[n])?Qe(e[n],t[n]):t[n]);return e}function We(e,t,n){var i;!e&&Ge(i=n.shift())||(i={});for(var r=0;n.length>r;++r){var o=n[r];if(Ge(o))for(var a in o)if("__proto__"!==a&&"constructor"!==a&&"prototype"!==a){var s=e?Fe(o[a]):o[a];i[a]=t?Qe(i[a],s):s}}return i}var Ve,Be,Ke=function(){var e,t,n;return{origin:null===(e=location)||void 0===e?void 0:e.origin,pathname:null===(t=location)||void 0===t?void 0:t.pathname,href:null===(n=location)||void 0===n?void 0:n.href}},Je=null,ze=Ke(),Xe=null,Ye=ze,Ze="",et=!1,tt=function(e){return"function"==typeof e};function nt(e,t){var n,i,r,o,a,s,c=null===(n=window)||void 0===n||null===(i=n.history)||void 0===i?void 0:i.pushState,u=null===(r=window)||void 0===r||null===(o=r.history)||void 0===o?void 0:o.replaceState,l=function(){t(location,Je)||e(location,Je)},f=!0,d=function(){var e;if(f=!f){var n=history.__proto__.pushState;n.apply(history,arguments)}else{Ze="pushState",Ye=Je=Ke();var i=Ve||c;Ve=null,i.apply(null===(e=window)||void 0===e?void 0:e.history,arguments),ze=Ke(),f=!0,l(),et?et=!1:t(ze,Je)||it.watchRoutes().forEach((function(e){return e(ze,Je)}))}},h=function(){var e;if(f=!f){var n=history.__proto__.replaceState;n.apply(history,arguments)}else{Ze="replaceState",Ye=Je=Ke();var i=Be||u;Be=null,i.apply(null===(e=window)||void 0===e?void 0:e.history,arguments),ze=Ke(),f=!0,l(),et?et=!1:t(ze,Je)||it.watchRoutes().forEach((function(e){return e(ze,Je)}))}},p=function(){(Je=ze)||Xe||(et=!0),Xe=ze,Ze||(Je=Xe),Ze="",ze=Ye=Ke(),l(),et?et=!1:t(Ye,Xe)||it.watchRoutes().forEach((function(e){return e(Ye,Xe)}))};tt(c)&&(window.history.pushState=d),tt(u)&&(window.history.replaceState=h),s=(null===(a=window)||void 0===a?void 0:a.document.documentMode)?"hashchange":c?"popstate":"hashchange",C(window,s,p);setTimeout((function e(){var t,n=!1,i=(null===(t=window)||void 0===t?void 0:t.history)||{};tt(c)&&i.pushState!==d&&(Ve=i.pushState,n=!0),tt(u)&&i.replaceState!==h&&(Be=i.replaceState,n=!0),n&&(A(window,s,p),C(window,s,p)),setTimeout(e,1e3)}),1e3)}var it=function(){function e(){P(this,e)}return U(e,null,[{key:"init",value:function(e,t,n){var i=this;if(this.inited)throw Error("TrackUrlListener重复初始化!");return this.listeners="function"==typeof t?[t]:N(this.listeners),this.isSingleApp=e,e&&nt((function(e,t){i.listeners.forEach((function(n){n(e,t)}))}),n),this.inited=!0,this}},{key:"push",value:function(e){e&&this.listeners.push(e)}},{key:"remove",value:function(e){this.listeners=this.listeners.filter((function(t){return t!==e}))}},{key:"getPrevUrl",value:function(){return this.isSingleApp&&Je?Je.href:document.referrer||""}},{key:"watchRoutes",value:function(e){return void 0!==e&&(this.routerListeners=e),this.routerListeners}}]),e}();it.listeners=[],it.routerListeners=[],it.isSingleApp=void 0,it.inited=void 0;var rt,ot,at,st={app_id:"",app_key:"",env:"prod",region:"sg",region_code:"",session_cutting_time:30,sdk_auto_track:!0,is_single_page_app:!0,is_track_visittime:!0,log_level:"info",reported_platforms:["web"],pageview:{delay:100,track_pageview_type:"auto",track_ignore:function(){return!1},is_trigger_pageload:!0,watch_utm:!0,url_alias:{}},exposure:{once:!0,duration_threshold:300,intersection_threshold:1,root_margin:"0px"},develop:{catch_js_error:!1,performance:!1,errorRatio:.2,errorSplit:500},app_version:"",is_cross_subdomain:!1,is_print_header:!1,event_rule:[],event_blacklist:[],project:"default",quarantine_report:!1},ct={balance:!0,flush:!0,is_print_header:!1,interval_time:1,max_batch_events:10,max_request_queue:10,fail_timeout:5,fail_retry_count:1};!function(e){e[e.INIT=0]="INIT",e[e.FETCH_CONFIG=1]="FETCH_CONFIG",e[e.READY=2]="READY"}(rt||(rt={})),function(e){e.TRACK="track",e.DEFERRED="deferred",e.REQUEST="request",e.TRACK_PENDING="track-pending"}(ot||(ot={})),function(e){e.BALANCE="balance",e.BALANCE_REQ="balance_req"}(at||(at={}));var ut,lt=[ot.TRACK],ft={eventId:"$page_view",eventGroup:"$track_page_view"},dt={eventId:"$page_duration",eventGroup:"$track_page_view"},ht={eventId:"$page_load",eventGroup:"$track_page_load"},pt={eventId:"$track_version",eventGroup:"$track_develop"},vt={eventId:"$",eventGroup:"$track_sensors"};!function(e){e.DOMESTIC="https://static-common.heytapdownload.com",e.FOREIGN="https://static-common.heytapdl.com",e.INTRANET="https://static-common.oppoer.me",e.FILES_COMMON="common-files"}(ut||(ut={}));var gt={utm:["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],search:["www.baidu.","m.baidu.","m.sm.cn","so.com","sogou.com","youdao.com","google.","yahoo.com/","bing.com/","ask.com/"],social:["weibo.com","renren.com","kaixin001.com","douban.com","qzone.qq.com","zhihu.com","tieba.baidu.com","weixin.qq.com"],keyword:{baidu:["wd","word","kw","keyword"],google:["q"],bing:["q"],yahoo:["p"],sogou:["query","keyword"],so:["q"],sm:["q"]}},mt=function(e){return"object"===n(e)&&(e=JSON.stringify(e)),function(e){for(var t,n,i,r,o="",a=0,s=(e+="").length%3;e.length>a;)((n=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255)&&console.log("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range."),o+=pe.charAt((t=n<<16|i<<8|r)>>18&63)+pe.charAt(t>>12&63)+pe.charAt(t>>6&63)+pe.charAt(63&t);return s?o.slice(0,s-3)+"===".substring(s):o}(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))},yt=function(e){if(!e)return e;var t=atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}));return decodeURIComponent(t.join(""))},_t=function(e){var t=mt(e);return{data:{data:t,crc:function(e){var t=0;if(0==e.length)return t;for(var n=0;e.length>n;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(t)},headers:{"Content-Type":"application/x-www-form-urlencoded"}}},wt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"SG";t=t||{};var i=Ce(n).toUpperCase(),r=(t["AreaCode_".concat(i)]||"").trim();return e?e[n.toUpperCase()]||e[i]||r:r||"https://obus-sg.dc.heytapmobile.com"},kt=function(e,t,n){return e.replace("$HOST",t).replace("$APPID",n)};function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Tt(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Et(e,t,n){return t&&It(e.prototype,t),n&&It(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;o.length>i;i++)0>t.indexOf(n=o[i])&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function At(e){return function(e){if(Array.isArray(e))return xt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}var Dt=["config_code"],$t={dev:"https://dev-appconf.wanyol.com",test:"https://app-conf.wanyol.com",getProdUrl:function(e){return"cn"===e?"https://appconf.heytapdownload.com":"sg"===e||"sgp"===e?"https://appconf-sgp.heytapdl.com":"https://appconf-".concat(e.toLocaleLowerCase(),".heytapdl.com")}},Pt=function(e){switch(e){case"cn":return"https://obus-jssdk-cn.heytapmobi.com";case"us":case"in":case"sg":return"https://obus-jssdk-".concat(e,".heytapmobile.com");case"eu":return"https://obus-jssdk-fr.heytapmobile.com";default:return"https://obus-jssdk-sg.heytapmobile.com"}},jt=function(){function e(t){St(this,e),this.cloudEnvDetector=null,this.cloudEnvDetector=new Ne(t)}return Et(e,[{key:"checkUpdateUrl",value:function(e,t){if(ae("__VPN__"))return e;var n=t||"sg",i=(Oe[n.toUpperCase()]||n).toLocaleLowerCase();return"".concat(Pt(i),"/api/checkUpdate")}},{key:"cdnUrl",value:function(e,t){if(ae("__VPN__"))return e;var n=t||"sg",i=(Oe[n.toUpperCase()]||n).toLocaleLowerCase();return"".concat(Pt(i),"/api/fetchCdnFile")}}]),e}(),Ut=function(){function e(t){if(St(this,e),this.options=void 0,this.configList=[],this.proxyConfigHost=void 0,this.options=Tt(Tt({},{env:"prod",countryCode:"cn",productId:"",expires:"6h",condition:null}),t),this.options.env=this.options.env||"prod",this.configList=ce(this.STORAGE_KEY)||[],this.proxyConfigHost=new jt(this.isDebugEnv()),ce(this.STORAGE_KEY_NO_USED))try{localStorage.removeItem(this.STORAGE_KEY_NO_USED)}catch(e){}}return Et(e,[{key:"fetch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Array.isArray(e)?e:[e],o=this.configMap,a=[];r=ee(r),i?a=r.map((function(e){return{configCode:e,version:0}})):r.forEach((function(e){o[e]?n.isConfigExpired(o[e])&&a.push({configCode:e,version:o[e].version}):a.push({configCode:e,version:0})}));var s=r.filter((function(e){return a.every((function(t){return e!==t.configCode}))})),c=s.map((function(e){return o[e]}));this.fetchConfig(a,(function(e,i){if(i=(i=i||[]).map((function(e){return Tt({name:e.config_code},Ct(e,Dt))})),-1===e)return t&&t.call(n,r.map((function(e){return n.configMap[e]}))),K.error("fetch config error occur.");K.debug("拉取配置".concat(i.map((function(e){return e.name})),"成功"),i),1===e&&n.writeStorage(i),t&&t.call(n,[].concat(At(i),At(c)))}))}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0,i=this.configList,r=i;t||(r=i.filter((function(t){return e.isConfigExpired(t)}))),this.fetchConfig(r.map((function(e){return{version:e.version,configCode:e.name}})),(function(t,i){if(-1===t)return K.error("fetch config error occur.");K.info("刷新应用云控配置成功, 即将刷新页面"),1===t&&(e.writeStorage(i),setTimeout((function(){"function"==typeof n&&n()}),200))}))}},{key:"writeStorage",value:function(e){var t=this,n=[],i={};e.forEach((function(e){i[e.name]=!0,n.push({name:e.name,version:e.version,expire:t.getExpireTime(e.interval_time),created:Date.now(),content:e.content})})),this.configList.forEach((function(e){i[e.name]||n.push(e)})),this.configList=n,ce(this.STORAGE_KEY,n)}},{key:"getExpireTime",value:function(e){return Date.now()+this.getExpireTimeMills(e)}},{key:"getExpireTimeMills",value:function(e){var t=this.options.expires||"",n=1;if(""!==(t=t.replace(/^\s+.*?\s+$/,""))&&t.length>=2){var i=t.charAt(t.length-1).toLocaleLowerCase();"d"===i?n=864e5:"h"===i?n=36e5:"m"===i?n=6e4:"s"===i&&(n=1e3)}return t?n*parseInt(t.slice(0,-1),10):1e3*e}},{key:"fetchConfig",value:function(e,t){var n=this,i=this.options,r={itemList:e,productId:i.productId};if(i.condition&&(r.systemCondition=i.condition),!e||Array.isArray(e)&&0===e.length)return t&&t(0,this.configList);K.debug("拉取云控配置",e.map((function(e){return e.configCode})));var o=this.getCheckUpdateUrl();Ee(this.proxyConfigHost.checkUpdateUrl(o,i.countryCode),{data:{body:JSON.stringify(r),url:o},reTryCount:2,success:function(e){if(200==+e.error_code){var i=e.item_list.filter((function(e){return e.version>0&&!!e.url}));if(!i||0===i.length)return K.warn("合法的配置树为0，请检查配置项名称"),t&&t(-1,null),!1;n.fetchCdnFile(i,(function(e,n){if(e)return K.info("拉取cdn文件异常"),t&&t(-1,null),!1;t&&t(1,n)}))}},fail:function(){return t&&t(-1,null),K.error("fetch config error")}})}},{key:"fetchCdnFile",value:function(e,t){var n=this,i=[],r=e.length;e.forEach((function(e){Ee(n.proxyConfigHost.cdnUrl(e.url,n.options.countryCode),{data:{url:e.url},reTryCount:2,success:function(n){r--,i.push(Tt(Tt({},e),{},{content:n})),0===r&&t&&t(!1,i)},fail:function(){0===r&&t&&t(!1,i)}})}))}},{key:"isConfigExpired",value:function(e){var t=Date.now();return!!e.created&&t-(null==e?void 0:e.created)>=this.getExpireTimeMills(1)||!!e.expire&&t>=(null==e?void 0:e.expire)}},{key:"config",get:function(){return this.configList}},{key:"getCheckUpdateUrl",value:function(){var e=this.options.env||"prod",t=this.options.countryCode||"sg",n="sg";return 0>["dev","test"].indexOf(e)?("prod"===e.toLocaleLowerCase()&&(n=(Oe[t.toUpperCase()]||t).toLocaleLowerCase()),"".concat($t.getProdUrl(n),"/js/v2/checkUpdate")):"".concat($t[e],"/js/v2/checkUpdate")}},{key:"isDebugEnv",value:function(){var e,t=(null===(e=location)||void 0===e?void 0:e.hostname)||"";return!!(/\.example$/.test(t)||"localhost"===t||/\.wanyol\.com$/.test(t)||-1!==t.indexOf("test")||-1!==t.indexOf("dev")||/^\d+(?:.\d+){3}$/.test(t))}},{key:"configMap",get:function(){for(var e={},t=0;this.configList.length>t;t++)e[this.configList[t].name]=this.configList[t];return e}},{key:"STORAGE_KEY",get:function(){return"__mdp_cloud_config/".concat(this.options.productId,"_").concat(this.options.env)}},{key:"STORAGE_KEY_NO_USED",get:function(){return"__mdp_cloud_config/".concat(this.options.productId)}}],[{key:"multiFetch",value:function(e,t){if("Array"!==Object.prototype.toString.call(e).slice(8,-1))throw Error("参数错误");if(e.forEach((function(e){if("function"!=typeof e)throw Error("参数错误")})),t.timeout=t.timeout||20,1===e.length)return e[0]((function(e){var n=Ot({},this.options.productId,te(e,"name",!0));return t.success(n)}));var n=e.length,i={},r=setTimeout((function(){n>0&&t.fail&&t.fail(i,e.length-n)}),1e3*t.timeout);e.forEach((function(e){e((function(e){i=Tt(Tt({},i),{},Ot({},this.options.productId,te(e,"name",!0))),0==--n&&(t.success(i),window.clearTimeout(r))}))}))}}]),e}();Ut.VERSION="1.5.46";var Lt={interval_time:[1,0,15],max_batch_events:[3,0,15],fail_timeout:[30,0,90],fail_retry_count:[1,0,3]};function Rt(e,t){for(var n in e)if(e.hasOwnProperty(n)){if("number"!=typeof e[n])continue;var i=+e[n],r=t[n];if(-1===i||void 0===r)continue;"number"==typeof r[0]&&(null==r[1]&&(r[1]=-1/0),void 0===r[2]&&(r[1]=1/0)),(r[1]>i||i>r[2])&&(i=+r[0]),e[n]=i}return e}var Mt=function(e){var t,n,i,r,o;if(function(e,t){he(e,(function(e,n){return-1===t.indexOf(n)}))}(e,["balance","flush","event_rule","event_blacklist"]),o=qe(!0,e),!e.app_id||!e.app_key||"**"==e.app_id)return console.error("app_id, app_key为空或者不合法"),[!1,""];if(e.env&&["test","pre","prod"].includes(e.env)||(o.env="prod"),e.region&&["sg","cn","in","eu","us"].includes(e.region.toLowerCase())||(K.warn("当前region为：".concat(e.region,",请填写正确的region，如：sg,cn,in,eu,us中的一个")),o.region="sg"),"number"!=typeof e.interval_time||15>=e.interval_time&&e.interval_time>0||(o.interval_time=1),"number"==typeof e.max_batch_events&&(e.max_batch_events>20||0>e.max_batch_events)&&(o.max_batch_events=3),"number"==typeof e.max_request_queue&&(e.max_request_queue>20||0>e.max_request_queue)&&(o.max_request_queue=10),(o.session_cutting_time>150||20>o.session_cutting_time)&&(o.session_cutting_time=30),I(null===(t=e.pageview)||void 0===t?void 0:t.track_ignore)){var a,s=null===(a=e.pageview)||void 0===a?void 0:a.track_ignore;o.pageview.track_ignore=function(e){return 0!==s.length&&-1!==s.indexOf(e.pathname)}}"number"==typeof(null===(n=e.pageview)||void 0===n?void 0:n.delay)&&(null===(i=e.pageview)||void 0===i?void 0:i.delay)>5e3&&0>(null===(r=e.pageview)||void 0===r?void 0:r.delay)&&(e.pageview.delay=10);var c=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{catch_js_error:e,performance:e,errorRatio:.2,errorSplit:500}};return"boolean"==typeof e.develop&&e.develop?o.develop=c(!0):"boolean"==typeof e.develop||e.develop||(o.develop=c()),o.develop=qe(!0,c(),e.develop),[!0,o]},Nt=function(e){if(!e)return{event_rule:[],event_blacklist:[],business:{}};e.event_rule=(null==e?void 0:e.event_rule)||[],e.event_blacklist=(null==e?void 0:e.event_blacklist)||[];var t=he(null==e?void 0:e.business,(function(e){return-1!==e}));return e.business=Rt(t,Lt),e},qt={},Ht=function(e,t){if(e.eventId=e.eventId+"",e.eventGroup=e.eventGroup+"",0===e.eventId.indexOf("$")&&/^\$track_/.test(e.eventGroup))return!1;if(0===t.event_rule.length)return!0;!qt.white&&t.event_rule&&t.event_rule.forEach((function(e){qt.white=qt.white||{},qt.white["".concat(e.eventId,"|").concat(e.eventGroup)]=!0})),!qt.black&&t.event_blacklist&&t.event_blacklist.forEach((function(e){var t=e.blackKey;qt.black=qt.black||{},(t&&I(t)&&t.length>=0||void 0===t)&&(qt.black["".concat(e.eventId,"|").concat(e.eventGroup)]=t)}));var n="".concat(e.eventId,"|").concat(e.eventGroup),i=!qt.white||!qt.white[n];if(!qt.black||!t.event_blacklist)return i;var r=qt.black[n];return!(!qt.black.hasOwnProperty(n)||void 0!==r)||(r&&r.length>0&&r.forEach((function(t){e.properties.hasOwnProperty(t)&&delete e.properties[t]})),i)},Ft=function(){function e(){i(this,e)}return o(e,null,[{key:"init",value:function(t,n){var i,r,o;this.oTrack=n;var s=p(Mt(t),2),c=s[0],u=s[1];if(this._conf)K.warn("基础配置不能重复初始化, 请检查");else if(c&&"string"!=typeof u){"prod"===u.env&&B.disableAllLog(),u.log_level&&B.setLogLevel(u.log_level),K.info("当前埋点SDK版本".concat(null===(i=e.pkgInfo)||void 0===i?void 0:i.version,", 当前云控SDK版本").concat("1.5.46")),K.info("用户配置",t),this._conf=He(!0,ct,st,u);var l="AreaCode_",f="https://",d=".heytapmobile.com",h="https://obus-dct-cn.heytapmobi.com";this.cfg={upload_host:"prod"===u.env?(r={},a(r,"".concat(l,"CN"),"".concat(f,"obus-cn.dc.heytapmobi.com")),a(r,"".concat(l,"IN"),"".concat(f,"obus-in.dc").concat(d)),a(r,"".concat(l,"SG"),"".concat(f,"obus-sg.dc").concat(d)),a(r,"".concat(l,"EU"),"".concat(f,"obus-dc-eu").concat(d)),a(r,"".concat(l,"US"),"".concat(f,"obus-dc-us").concat(d)),r):(o={},a(o,"".concat(l,"CN"),h),a(o,"".concat(l,"IN"),h),a(o,"".concat(l,"SG"),h),a(o,"".concat(l,"EU"),h),a(o,"".concat(l,"US"),h),o)},this.uploadHost=wt("",this.cfg.upload_host,u.region),this.fetchCloudConfig(u)}else K.error(u)}},{key:"fetchCloudConfig",value:function(e){var t=this,n=this.pkgInfo.version,i=+n.split(".")[0]>1?+n.split(".")[0]:1,r="TrackGlobalWeb".concat(i),o="BUSINESS_WEB_".concat(e.app_id,"_CONFIG");"pre"!==e.env&&"test"!==e.env||(r="".concat(r,"_").concat(e.env)),this.readyState=rt.FETCH_CONFIG,this.uploadHost=wt("",this.cfg.upload_host,e.region),this.cloudAppConfig=new Ut({env:e.env&&"prod"===e.env.toLowerCase()?"prod":"test",productId:"compass_".concat(e.app_id),countryCode:e.region,expires:"prod"===e.env?"3h":"30s",condition:{regionCode:"eu"===e.region.toLowerCase()?"EUEX":e.region}}),Ut.multiFetch([function(e){return t.cloudAppConfig.fetch([o],e)}],{success:function(n){var i,r,a,s=null===(i=n["compass_".concat(e.app_id)][o])||void 0===i?void 0:i.content,c=(null===(r=s)||void 0===r?void 0:r.domain)||"";K.debug("应用ID:"+e.app_id,"应用配置",s),s||K.error("云控配置拉取异常","请你先在OBus创建类型为web的应用, 有问题请联系80252692, 80346696");var u,l=null===(a=s=Nt(s))||void 0===a?void 0:a.business,f=s||{event_rule:[],event_blacklist:[]},d=He(!0,ct,st,e,{appDomain:c,event_rule:f.event_rule,event_blacklist:f.event_blacklist},l),h=ce("host")||"";if(""===(u=function(){var e=window.location.host;return e.indexOf("localhost")>=0||e.indexOf(".example")>=0||e.indexOf(".wanyol.com")>=0||/\d+(.\d+)+/.test(e)}()&&""!==h?h:wt(c,t.cfg.upload_host,d.region))||!/^https?:\/\//.test(u))return K.error("云控配置",u,"上报域名不合法, 请联系OBus"),!1;it.init(d.is_single_page_app,[],d.pageview.track_ignore),t.uploadHost=u,t.readyState=rt.READY,t._conf=d,t.consumeListeners(),K.debug("应用ID:"+d.app_id,"host: ".concat(u),"埋点配置",d)},fail:function(e,n){K.error("应用ID:"+e.app_id,"拉取云配置失败"),t.readyState=rt.INIT}})}},{key:"registerCallbacks",value:function(e){this.isReady()?(this.listeners.push(e),this.consumeListeners()):this.listeners.push(e)}},{key:"setPkgInfo",value:function(e){this.pkgInfo=e}},{key:"getPkgInfo",value:function(){return this.pkgInfo}},{key:"config",get:function(){if(!this._conf)throw Error("配置没有初始化");return this._conf}},{key:"isReady",value:function(){return this.readyState===rt.READY}},{key:"consumeListeners",value:function(){var e=this;this.listeners.forEach((function(t){E(t)&&t(e._conf)})),this.listeners=[]}}]),e}();Ft._conf=void 0,Ft.pkgInfo=void 0,Ft.readyState=rt.INIT,Ft.cloudGlobalConfig=void 0,Ft.cloudAppConfig=void 0,Ft.listeners=[],Ft.uploadHost="",Ft.oTrack=void 0,Ft.cfg=void 0;var Gt=30,Qt=K.clone({namespace:"DB读写"}),Wt=function(){function e(){i(this,e),this.getVersion=function(){return Date.now()}}return o(e,[{key:"writeTypeStgSafe",value:function(e,t){var n,i,r=0;do{var o=t((n=this.readTypeStg(e)).data);if(!1===o)return n.data;n.data=o||n.data,i=this.readTypeStg(e)}while(i&&n.version!==i.version&&r++<=Gt);if(r>Gt)console.warn("writeTypeStgSafe try count greater than 30");else if(n.data===i.data&&n.data.length===i.data.length)return i.data||[];return this.writeTypeStg(e,{data:n.data,version:this.getVersion()}),n.data||[]}},{key:"writeTypeStgMultiSafe",value:function(e,t){var n=this,i=0,r=[],o=e.map((function(e){return n.readTypeStg(e)})),a=function(){var t=o&&i++<=Gt*e.length;return e.forEach((function(e,n){t=t&&o[n].version!==r[n].version})),t};do{var s=(r=e.map((function(e){return n.readTypeStg(e)}))).map((function(e){return e.data})),c=t.apply(void 0,v(s));if(!1===c)return!1;r=(c=c||s).map((function(e,t){return{version:r[t].version,data:e}})),o=e.map((function(e){return n.readTypeStg(e)}))}while(a());i>Gt&&console.warn("writeTypeStgSafe try count greater than 30"),e.forEach((function(e,t){n.writeTypeStg(e,{data:r[t].data,version:n.getVersion()})}))}},{key:"readTypeStg",value:function(e){var t=ce(this.getStgQueueName(e)),n=this.getDefValAndType(e);if(n&&O(null==t?void 0:t.data)!==n[0]){var i={data:n[1],version:this.getVersion()};return this.writeTypeStg(e,i),i}return t}},{key:"readStg",value:function(e){return ce(e)}},{key:"writeTypeStg",value:function(e,t){var n=this.getDefValAndType(e);return n&&n[0]!==O(null==t?void 0:t.data)?(Qt.error(e,"写入类型".concat(O(null==t?void 0:t.data),"和期待类型").concat(n[0],"不一致")),this.readTypeStg(e),!1):(ce(this.getStgQueueName(e),t,!0),!0)}},{key:"writeStg",value:function(e,t){ce(e,t,!0)}},{key:"getDefValAndType",value:function(e){return"balance"===e?["Object",{}]:["Array",[]]}},{key:"getStgQueueName",value:function(e){return"obus-track_".concat(Ft.config.app_id,"/").concat(e,"-queue")}}]),e}(),Vt="otrack_jssdk_store",Bt=function(){function e(){i(this,e),this.userId="",this.appVersion="",this.customAttrs=null,this.isWebview=!1,this.region="",this.isFirstDay=!1,this.isFirstTime=!1,this.isLogin=!1,this.deviceId="",this.initStore();var t=!1;if(ae(Vt)){var n=null;try{n=ie(yt(ae(Vt))||"null")}catch(e){try{n=ie(ae(Vt)||"null")}catch(e){K.error("cookies 设备信息获取失败")}}n&&(this.deviceId=n.deviceId||"",this.userId=n.userId||"",this.customAttrs=n.customAttrs||{},this.isLogin=!!this.userId,this.isFirstDay=ie(ae("otrack_jssdk_is_first_day")||"false"),n.deviceId||(this.deviceId=fe(),this.isFirstTime=!0,this.isFirstDay=!0,t=!0))}else""===this.deviceId&&(this.deviceId=fe(),this.isFirstTime=!0,this.isFirstDay=!0,t=!0);if(t){var r=new Date;r.setDate(r.getDate()+1),r.setHours(0,0,0,0),this.writeStore(),re("otrack_jssdk_is_first_day",ne(this.isFirstDay),r,{cross_subdomain:Ft.config.is_cross_subdomain})}}return o(e,[{key:"initStore",value:function(){var e=Ft.config.is_cross_subdomain,t=ae(Vt),n="otrack_jssdk_is_first_day",i=ae(n),r=new Date;r.setDate(r.getDate()+1),r.setHours(0,0,0,0),e?(re(Vt,"",-1),re(n,"",-1)):(re(Vt,"",-1,{cross_subdomain:!0}),re(n,"false",-1,{cross_subdomain:!0}));var o=ae(Vt);null!=t&&null==o&&(re(Vt,t,73e3,{cross_subdomain:e}),i&&re(n,i,r,{cross_subdomain:e}))}},{key:"getCustomHead",value:function(){return this.customAttrs||{}}},{key:"getDeviceId",value:function(){return this.deviceId}},{key:"setCustomHead",value:function(e){if(void 0===e)return this.customAttrs={},void this.writeStore();if(T(e)){for(var n in e)null==e[n]&&(e[n]="");this.customAttrs=t(t({},this.customAttrs),e),this.writeStore()}else K.error("registerGlobalAttrs的参数必须是属性")}},{key:"setAppVersion",value:function(e){this.appVersion=e||""}},{key:"getAppVersion",value:function(){return this.appVersion||""}},{key:"setDeviceId",value:function(e){this.deviceId=e||"",K.info("".concat((new Date).toLocaleString()," setDeviceId: ").concat(this.deviceId)),this.writeStore()}},{key:"setUserId",value:function(e){if("string"!=typeof e)return K.error("userId的数据类型必需为string");this.userId=e||"",this.isLogin=!!this.userId,K.info("".concat((new Date).toLocaleString()," setUserId: ").concat(this.userId)),this.writeStore()}},{key:"setIsWebview",value:function(e){this.isWebview=!!e}},{key:"getIsWebview",value:function(){return this.isWebview}},{key:"getUserId",value:function(){return this.userId}},{key:"writeStore",value:function(){re(Vt,mt(ne({deviceId:this.deviceId,userId:this.userId,customAttrs:this.customAttrs})),73e3,{cross_subdomain:Ft.config.is_cross_subdomain})}},{key:"isFirstDayFromCookies",value:function(){var e=this.isFirstDay&&ie(ae("otrack_jssdk_is_first_day")||"null");return!e&&this.isFirstDay&&(this.isFirstDay=!1),e}}]),e}(),Kt=K.clone({namespace:"对账数据",isShowLog:!1}),Jt=function(e){s(n,e);var t=h(n);function n(){var e;i(this,n);for(var r=arguments.length,o=Array(r),a=0;r>a;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).memoryCache={events:[],posts:[]},e.timerMap={events:0,posts:0},e.totalCreate=0,e.reportTotalCreate=[0,0],e}return o(n,[{key:"registerCreate",value:function(e,t){this.memoryCache.events.push(e),this.memoryCache.events.length>20&&(this.timerMap.events=window.setTimeout(this.registerMemoCb.bind(this),0)),0===this.timerMap.events&&(this.timerMap.events=window.setTimeout(this.registerMemoCb.bind(this),50))}},{key:"registerUpload",value:function(e,t){this.register(e,1,t)}},{key:"registerMemoCb",value:function(e){this.register(this.memoryCache.events,0,e),this.memoryCache.events=[],window.clearTimeout(this.timerMap.events),this.timerMap.events=0}},{key:"register",value:function(e,t,n){var i=this;if(e){var r={},o=0===t?"event_count":"post_count";(e&&I(e)?e:[e]).map((function(e,t){return 60*Math.floor(+e.$event_time/6e4)*1e3})).forEach((function(e){0===t&&(i.totalCreate+=1),r[e]=r[e]?r[e]+1:1})),this.reportTotalCreate[t]+=Object.keys(r).reduce((function(e,t){return e+r[t]}),0),Kt.debug("[对账调试]对账数据产生内存统计",o,this.reportTotalCreate);var a=this.writeTypeStgSafe(at.BALANCE,(function(e){for(var t in Kt.debug("[对账调试]写入前",e),Kt.debug("[对账调试]写入中",o,r),r)r.hasOwnProperty(t)&&(e[t]=e[t]||{sequence_id:fe(),event_count:0,post_count:0},e[t][o]+=r[t]);return e}));Kt.debug("[对账调试]写入后",a)}}}]),n}(Wt),zt=function(){function e(){i(this,e)}return o(e,null,[{key:"userInfo",get:function(){return this._userInfoInst||(this._userInfoInst=new Bt),this._userInfoInst}},{key:"trackBalanceCreate",get:function(){return this._balanceGenInst||(this._balanceGenInst=new Jt),this._balanceGenInst}}]),e}();zt._userInfoInst=void 0,zt._balanceGenInst=void 0;var Xt,Yt=function(){function e(){var t=this;i(this,e),this.spanConf={life:864e5,renewal:18e5,cookieUpdateInterval:6e4},this.cookieNameConst=void 0,this.sessionMeta=void 0,this.cookieUpdatedTime=0,this.sessionMeta={id:"",createTime:0,renewalTime:0},this.cookieNameConst="obus-track_"+Ft.config.app_id+"_session",this.spanConf.renewal=6e4*Ft.config.session_cutting_time,this.sessionMeta.id||this.restoreSession(),C(window,"beforeunload",(function(){t.persist()})),C(window,"unload",(function(){t.persist()}))}return o(e,[{key:"update",value:function(){var e=Date.now();e-this.sessionMeta.createTime>this.spanConf.life||e-this.sessionMeta.renewalTime>this.spanConf.renewal||""==this.sessionMeta.id?this.renew():this.cookieUpdatedTime&&this.spanConf.cookieUpdateInterval>=e-this.cookieUpdatedTime||(this.sessionMeta.renewalTime=e,this.setCookies())}},{key:"getSessionId",value:function(){return this.sessionMeta.id}},{key:"restoreSession",value:function(){var e=ae(this.cookieNameConst);if(e)this.restoreSessionWithData(e);else{var t=ce(this.cookieNameConst);t&&this.restoreSessionWithData(t)}this.sessionMeta.id||this.renew()}},{key:"restoreSessionWithData",value:function(e){var t=e.split(",");t.length>0&&(this.sessionMeta.id=t[0]);try{t.length>1&&(this.sessionMeta.createTime=+new Date(+t[1]),this.sessionMeta.createTime=this.sessionMeta.createTime>0?this.sessionMeta.createTime:0),t.length>2&&(this.sessionMeta.renewalTime=+new Date(+t[2]),this.sessionMeta.renewalTime=this.sessionMeta.renewalTime>0?this.sessionMeta.renewalTime:0)}catch(e){console.log("otrack 日期初始化异常")}}},{key:"renew",value:function(){this.sessionMeta={id:Y(),createTime:Date.now(),renewalTime:Date.now()},this.setCookies()}},{key:"setCookies",value:function(){var e=this.sessionMeta,t=e.createTime+this.spanConf.life,n=e.renewalTime+this.spanConf.renewal,i=t>n?n:t;re(this.cookieNameConst,[e.id,e.createTime,e.renewalTime].join(","),new Date(i),{cross_subdomain:Ft.config.is_cross_subdomain}),this.cookieUpdatedTime=Date.now()}},{key:"persist",value:function(){var e=this.sessionMeta;ce(this.cookieNameConst,[e.id,e.createTime,e.renewalTime].join(","))}}]),e}(),Zt=function(){function e(){i(this,e),this.session=void 0,this.session=new Yt}return o(e,[{key:"getHeader",value:function(){var e,i,r=zt.userInfo,o={$platform:"web",$lib_version:(null===(e=Ft.getPkgInfo())||void 0===e?void 0:e.version)||"",$lib_type:"object"===("undefined"==typeof exports?"undefined":n(exports))&&"undefined"!=typeof module?"npm":"script",$timezone_offset:(new Date).getTimezoneOffset(),$screen_height:Number(screen.height)||0,$screen_width:Number(screen.width)||0,$orientation:$e,$doc_width:xe,$doc_height:De,$connection_type:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&e.effectiveType||""},$browser_type:Ue.type,$browser_version:Ue.versions,$os:Le+","+(r.getIsWebview()?"webview":Ae.device),$session_id:this.session.getSessionId(),$browser_language:navigator.language||navigator.userLanguage||"",$browser_charset:(null===(i=document)||void 0===i?void 0:i.charset.toUpperCase())||""},s={$region:function(){return Ft.config.region},$region_code:function(){return Ft.config.region_code},$device_id:function(){return zt.userInfo.deviceId},$is_login:function(){return zt.userInfo.isLogin},$user_id:r.getUserId.bind(r),$app_version:r.getAppVersion.bind(r)},c=t(t({},o),s),u=Object.create(null);return Object.keys(c).forEach((function(e){var t=c[e];Object.assign(u,a({},e,"function"==typeof t?t():t))})),this.session.update(),u}}]),e}(),en=["head","pending"],tn=function(e){s(r,e);var n=h(r);function r(e){var t;return i(this,r),(t=n.call(this)).isSending=!1,t.continueFailCount=0,t.failIgnoreList=[],t.identity=void 0,t.logId="",t.options=void 0,t.url="",t.reportHeader=void 0,t.consumeStartThrottle=null,t.options=e,t.identity=e.identity,t.reportHeader=new Zt,t.url=kt("$HOST/v3/track/js/$APPID",Ft.uploadHost,Ft.config.app_id),t.consumeStart(!0),t}return o(r,[{key:"consumeStart",value:function(e,t){this.consumeStartThrottle||(this.consumeStartThrottle=ve(this.consumeStartOrg.bind(this),100,{leading:!0})),this.consumeStartThrottle(e,t)}},{key:"consumeStartOrg",value:function(e,t){var n,i=this.readTypeStg(this.options.queue);if(!i||0===(null==i||null===(n=i.data)||void 0===n?void 0:n.length)||this.isSending)return!1;this.logId=t||"",this.isSending=!0,this.startTask(e,0)}},{key:"startTask",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.readTypeStg(this.options.queue),o=r.data.filter((function(e){return!n.failIgnoreList.includes(n.identity(e))})).filter((function(t){return e||1!==t.pending})),a=o.shift();if(!(a&&Object.keys(a).length&&(a.body.length||Object.keys(a.body).length)&&this.isSending&&5>i))return this.stopTask();this.continueFailCount++;var s=Date.now(),c=this.getRequestData(a),u=c.head,f=l(c,en);ae("__VPN__")&&K.error("埋点聚合",t({head:u},f));var d=_t(t({head:u},f));this.setItemStatus(c,1),Ee(this.url+"?app_key=".concat(Ft.config.app_key,"&timestamp=").concat(s),t(t({},d),{},{method:"POST",timeout:Ft.config.fail_timeout,reTryCount:Ft.config.fail_retry_count,success:function(){n.success&&n.success(c),n.cleanDb(c),n.startTask(e,0)},fail:function(t,r){switch(t=t||"",+((r=r||999)||999)){case 442:case 435:n.cleanDb(c),n.logger.error(n.logId,"原因: ".concat(t,", code: ").concat(r," 处于[442, 435], 上报失败本地删除数据"),f);break;case 999:n.logger.error(n.logId,"原因: ".concat(t,", code: ").concat(r," 不处于[442, 435], 上报失败本地不删除数据"),f),n.setItemStatus(c,0),n.failIgnoreList.push(n.identity(c));break;default:(Ie()||408!=r)&&n.logger.error(n.logId,"上报失败，原因: ".concat(t,", code: ").concat(r),f),n.setItemStatus(c,0)}n.startTask(e,++i)}}))}},{key:"stopTask",value:function(){return this.isSending=!1,this.continueFailCount=0,this.failIgnoreList=[],this.options.consumeEnd&&this.options.consumeEnd(),!1}},{key:"cleanDb",value:function(e){var t=this;this.writeTypeStgSafe(this.options.queue,(function(n){var i=n.filter((function(n){return t.identity(e)!==t.identity(n)}));return i.length!==n.length&&i}))}},{key:"setItemStatus",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.writeTypeStgSafe(this.options.queue,(function(r){var o=r.map((function(r){return n.identity(e)===n.identity(r)?t(t({},r),{},{pending:i}):r}));return o.length>0&&o}))}},{key:"sendBeacon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isSending=!0,this.startTask(e,t)}}]),r}(Wt),nn=["head"],rn=function(e){s(r,e);var n=h(r);function r(){var e;return i(this,r),(e=n.call(this,{queue:at.BALANCE_REQ,identity:function(e){return e.request_id}})).logger=K.clone({namespace:"对账上报",isShowLog:!0,isShowMills:!1}),e.url=kt("$HOST/v3/balance/js/$APPID",Ft.uploadHost,Ft.config.app_id),e}return o(r,[{key:"getRequestData",value:function(e){return e.body.eventCompleteness=ne(e.body.eventCompleteness),t(t({},e),{},{head:this.reportHeader.getHeader(),custom_head:zt.userInfo.getCustomHead()})}},{key:"success",value:function(e){var t=l(e,nn);this.logger.debug("上报成功",Ft.config.is_print_header?e:t)}},{key:"report",value:function(){var e=this.readTypeStg(at.BALANCE),t=Object.keys(e.data).sort((function(e,t){return+e-+t}));if(0>=t.length)return!1;this.writeTypeStgMultiSafe([at.BALANCE,at.BALANCE_REQ],(function(e,t){if(!e||!Object.keys(e).length)return!1;var n={request_id:Y(),body:{eventCompleteness:e}};return t.push(n),[{},t]})),this.consumeStart(!1)}}]),r}(tn),on=["head"],an=function(e){s(r,e);var n=h(r);function r(){var e;i(this,r);var t=0,o=0;return(e=n.call(this,{queue:ot.REQUEST,consumeEnd:function(){var n;(t&&(window.clearTimeout(t),t=0),"number"==typeof Ft.config.balance_stats_interval&&Ft.config.balance_stats_interval)?(o&&(window.clearTimeout(o),o=0),t=window.setTimeout((function(){e.writeTypeStg(ot.TRACK_PENDING,{data:[],version:Date.now()})}),1e3*Ft.config.balance_stats_interval+2e3),o=window.setTimeout((function(){var t;null===(t=e.balanceReport)||void 0===t||t.report()}),1e3*Ft.config.balance_stats_interval)):(t=window.setTimeout((function(){e.writeTypeStg(ot.TRACK_PENDING,{data:[],version:Date.now()})}),2e3),null===(n=e.balanceReport)||void 0===n||n.report())},identity:function(e){return e.request_id}})).balanceReport=void 0,e.url="",e.logger=K.clone({namespace:"埋点上报",isShowLog:!0,isShowMills:!1}),e.url=kt("$HOST/v3/track/js/$APPID",Ft.uploadHost,Ft.config.app_id),Ft.config.balance&&(e.balanceReport=new rn),e}return o(r,[{key:"getRequestData",value:function(e){return t(t({},e),{},{head:this.reportHeader.getHeader(),custom_head:zt.userInfo.getCustomHead()})}},{key:"success",value:function(e){l(e,on);this.logger.info("上报成功",e.body.map((function(e){return e.$sequence_id}))),zt.userInfo.isFirstTime=!1,zt.trackBalanceCreate.registerUpload(e.body,this.logId)}}]),r}(tn),sn=["browser_type","browser_version"],cn=function(e,t,n){var i=function(e){var t={};return Object.keys(e).forEach((function(n){var i=0===n.indexOf("$")?n.replace("$",""):n;t[i]=e[n]})),t},r={head:l(i(e),sn),body:function(e){return Array.isArray(e)?e.map((function(e){return i(e)})):[i(e)]}(t),custom_head:i(n)};return r},un=["properties"],ln=function(){return Y(4,{letters:!1})},fn=!1,dn=function(e){s(a,e);var r=h(a);function a(e){var n,o,s;i(this,a),(s=r.call(this)).durationEventMap={},s.batchSend=void 0,s.trackTimer=0,s.logId=ln(),s.consumeTrackCount=0,s.customPropertiesAttach=function(){return{}},s.headInfo=null===(n=new an)||void 0===n||null===(o=n.balanceReport)||void 0===o?void 0:o.reportHeader.getHeader(),s.browserInfo=function(){var e=navigator.userAgent.toLowerCase(),t=function(t){return t.test(e)},n=function(t){return(""+e.match(t)).replace(/[^0-9|_.]/g,"").replace(/_/g,".")},i="unknow";t(/windows|win32|win64|wow32|wow64/g)?i="windows":t(/macintosh|macintel/g)?i="macos":t(/x11/g)?i="linux":t(/android|adr/g)?i="android":t(/ios|iphone|ipad|ipod|iwatch/g)&&(i="ios");var r="unknow";"windows"===i?t(/windows nt 5.0|windows 2000/g)?r="2000":t(/windows nt 5.1|windows xp/g)?r="xp":t(/windows nt 5.2|windows 2003/g)?r="2003":t(/windows nt 6.0|windows vista/g)?r="vista":t(/windows nt 6.1|windows 7/g)?r="7":t(/windows nt 6.2|windows 8/g)?r="8":t(/windows nt 6.3|windows 8.1/g)?r="8.1":t(/windows nt 10.0|windows 10/g)&&(r="10"):"macos"===i?r=n(/os x [\d._]+/g):"android"===i?r=n(/android [\d._]+/g):"ios"===i&&(r=n(/os [\d._]+/g));var o="unknow";"windows"===i||"macos"===i||"linux"===i?o="desktop":("android"===i||"ios"===i||t(/mobile/g))&&(o="mobile");var a="unknow",s="unknow";t(/applewebkit/g)?(a="webkit",t(/edge/g)?s="edge":t(/opr/g)?s="opera":t(/chrome/g)?s="chrome":t(/safari/g)&&(s="safari")):t(/gecko/g)&&t(/firefox/g)?(a="gecko",s="firefox"):t(/presto/g)?(a="presto",s="opera"):t(/trident|compatible|msie/g)&&(a="trident",s="iexplore");var c="unknow";"webkit"===a?c=n(/applewebkit\/[\d._]+/g):"gecko"===a?c=n(/gecko\/[\d._]+/g):"presto"===a?c=n(/presto\/[\d._]+/g):"trident"===a&&(c=n(/trident\/[\d._]+/g));var u="unknow";"chrome"===s?u=n(/chrome\/[\d._]+/g):"safari"===s?u=n(/version\/[\d._]+/g):"firefox"===s?u=n(/firefox\/[\d._]+/g):"opera"===s?u=n(/opr\/[\d._]+/g):"iexplore"===s?u=n(/(msie [\d._]+)|(rv:[\d._]+)/g):"edge"===s&&(u=n(/edge\/[\d._]+/g));var l="none",f="unknow";return t(/micromessenger/g)?(l="wechat",f=n(/micromessenger\/[\d._]+/g)):t(/qqbrowser/g)?(l="qq",f=n(/qqbrowser\/[\d._]+/g)):t(/ucbrowser/g)?(l="uc",f=n(/ucbrowser\/[\d._]+/g)):t(/qihu 360se/g)?l="360":t(/2345explorer/g)?(l="2345",f=n(/2345explorer\/[\d._]+/g)):t(/metasr/g)?l="sougou":t(/lbbrowser/g)?l="liebao":t(/maxthon/g)&&(l="maxthon",f=n(/maxthon\/[\d._]+/g)),Object.assign({engine:a,engineVs:c,platform:o,supporter:s,supporterVs:u,system:i,systemVs:r},"none"===l?{}:{shell:l,shellVs:f})}(),s.oTrack=null,s.pickEventQToReqQThrottle=null,s.flush=ve((function(){return!Ft.isReady()&&(!!Ft.config.flush&&void s.pickEventQToReqQ(2))}),2e3,{leading:!0});var c=t({},e);return void 0!==c.oTrack&&(s.oTrack=c.oTrack),Ft.registerCallbacks((function(e){var t,n,i,r=s.readTypeStg(ot.DEFERRED);(s.batchSend=new an,e.app_version&&zt.userInfo.setAppVersion(""+e.app_version||""),K.info(e.app_id+" 当前环境: ".concat(e.env||"prod"),"设备ID: ".concat(null===(t=zt.userInfo)||void 0===t?void 0:t.deviceId)),e.is_print_header)&&K.info("公共头",null===(n=s.batchSend)||void 0===n||null===(i=n.balanceReport)||void 0===i?void 0:i.reportHeader.getHeader());r.data.length&&(s.readTypeStg(ot.DEFERRED).data.forEach((function(e){var t,n=g(t=e)||m(t)||y(t)||w(),i=n[0],r=n.slice(1);-1!==["track"].indexOf(i)&&s[i].apply(f(s),r)})),s.writeTypeStgSafe(ot.DEFERRED,(function(){return[]}))),s.pickEventQToReqQOriginal(3)})),fn||(fn=!0,C(window,"beforeunload",(function(){var e;Ie(!1),null===(e=s.batchSend)||void 0===e||e.sendBeacon(!0)})),C(window,"unload",(function(){var e;Ie(!1),null===(e=s.batchSend)||void 0===e||e.sendBeacon(!0)})),C(window,"online",(function(){var e;null===(e=s.batchSend)||void 0===e||e.consumeStart(!0)}))),s}return o(a,[{key:"track",value:function(e,i){var r,o,a,s,c=arguments,u=Ft.config.pageview.url_alias,f=Ft.config.reported_platforms,d=Ft.config.quarantine_report,h={};if(this.logId=ln(),e.eventId)if(e.eventGroup)if(i&&"function"!=typeof i)K.error("track方法回调函数参数非法");else{var p,g;if(e.properties=e.properties||{},void 0===e.properties.data_sequence_id&&(e.properties.data_sequence_id=this.oTrack.getDataSequenceId()),dt.eventId!==e.eventId)h.$title=e.title||u[location.pathname||"/"]||document.title,h.$referrer=it.getPrevUrl(),h.$referrer_host=(null===(p=me(h.$referrer))||void 0===p?void 0:p.host)||"",h.$url=document.URL||document.documentURI||location.href||"",h.$url_path=location.pathname||"/"+h.$url.replace(/(#.*)/,"").split("/").slice(3).join("/");else h.$title=e.title,h.$referrer=e.referrer,h.$referrer_host=(null===(g=me(h.$referrer))||void 0===g?void 0:g.host)||"",h.$url=e.url,h.$url_path=e.url_path;if(ft.eventId===e.eventId?(h.$is_first_day=e.is_first_day,h.$is_first_time=e.is_first_time):this.oTrack.getAutoTrackParam&&(e.properties=t(t({},ye(this.oTrack.getAutoTrackParam()())),e.properties)),Ft.isReady()){var m=Ft.config,y=m.event_rule,_=m.event_blacklist,w=Ht(e,{event_rule:y,event_blacklist:_});if(w)K.warn("事件被过滤",e);else{Ft.config.pageview.watch_utm&&(e.properties=t(t({},e.properties),this.oTrack.getUtm(e.properties))),e.properties=t(t(t({},t({},this.oTrack.store.getSessionProps())),e.properties),this.customPropertiesAttach());var k=Ft.config.on_track;if(k&&"function"==typeof k){var b=e.eventId,T=e.eventGroup,S=e.properties,I=l(e,un);k.call(this.oTrack,{oTrack:this.oTrack,properties:S,context:I}),e.eventId=b,e.eventGroup=T}e.properties=t(t({},e.properties),{},{_track_id:Number((be()+"").slice(2,5)+(be()+"").slice(2,4)+((new Date).getTime()+"").slice(-4)),_flush_time:(new Date).getTime(),$item_id:(e.item_id||"")+"",$item_type:(e.item_type||"")+"",$project:Ft.config.project}),e.properties.$item_id&&e.properties.$item_type||(delete e.properties.$item_id,delete e.properties.$item_type);var E=t(t({},h),{},{$event_id:e.eventId,$event_group:e.eventGroup,$event_info:ne(e.properties),$event_time:0===e.eventId.indexOf("$")&&e.properties.$visit_time?e.properties.$visit_time:Date.now(),$sequence_id:fe()});if(K.info(this.logId,"埋点产生",E,n(E)),d)this.pushTrackQueue(ot.TRACK,E,i);else{var O=(null===(r=window)||void 0===r||null===(o=r.App_AutoEvent_Js_Bridge)||void 0===o?void 0:o.track)||(null===(a=window)||void 0===a||null===(s=a.App_Js_Bridge)||void 0===s?void 0:s.track);if(!f.includes("web")||O){var C=cn(this.headInfo,E,zt.userInfo.getCustomHead());f.includes("app")&&O?0!==(null==E?void 0:E.$event_id.indexOf("$"))?window.App_Js_Bridge.track(JSON.stringify(C)):window.App_AutoEvent_Js_Bridge.track(JSON.stringify(C)):K.info("未配置app上报或H5不在app中访问")}else this.pushTrackQueue(ot.TRACK,E,i)}}}else this.writeTypeStgSafe(ot.DEFERRED,(function(e){return e.push(["track"].concat(v([].slice.call(c)))),e}))}else K.error("track方法事件模块必填");else K.error("track方法eventId不能为空")}},{key:"startEvent",value:function(e,t){if(this.durationEventMap["".concat(e,"-").concat(t)])return K.warn("event id: ".concat(e,", event group: ").concat(t," 已经start")),!1;K.info("startEvent event id: ".concat(e,", event group: ").concat(t)),this.durationEventMap["".concat(e,"-").concat(t)]=(new Date).getTime()}},{key:"stopEvent",value:function(e,t,n){if(!this.durationEventMap["".concat(e,"-").concat(t)])return K.warn("event id: ".concat(e,", event group: ").concat(t," 未开始")),!1;K.info("Stop event id: ".concat(e,", event group: ").concat(t,", props: "),n),n.$duration=(new Date).getTime()-this.durationEventMap["".concat(e,"-").concat(t)],delete this.durationEventMap["".concat(e,"-").concat(t)],this.track({eventId:e,eventGroup:t,properties:n})}},{key:"pushTrackQueue",value:function(e,t,n){var i=this;if(-1===lt.indexOf(e))return K.warn(this.logId,"未知的事件类型 type: ".concat(e)),!1;zt.trackBalanceCreate.registerCreate(t,this.logId);var r=this.writeTypeStgSafe(e,(function(e){return e.every((function(e){return e.$sequence_id!==t.$sequence_id}))&&e.push(t),e}));return Ft.config.fast?(this.pickEventQToReqQ(2),void(n&&n(this))):n?(this.pickEventQToReqQ(2),void n(this)):(Ft.config.max_batch_events>r.length||setTimeout((function(){i.pickEventQToReqQ(0),window.clearTimeout(i.trackTimer),i.trackTimer=0}),30*Math.random()),void(0===this.trackTimer&&(this.trackTimer=window.setTimeout((function(){i.pickEventQToReqQ(1),i.trackTimer=0}),1e3*Ft.config.interval_time))))}},{key:"pickEventQToReqQ",value:function(e){return this.pickEventQToReqQThrottle||(this.pickEventQToReqQThrottle=ve(this.pickEventQToReqQOriginal.bind(this),100,{leading:!0})),this.pickEventQToReqQThrottle(e)}},{key:"pickEventQToReqQOriginal",value:function(e){var t,n=this,i=Ft.config.max_batch_events;4!==e&&(this.consumeTrackCount=0);this.writeTypeStgMultiSafe([ot.TRACK,ot.REQUEST],(function(e,t){if(!e||!e.length||t.length>=Ft.config.max_request_queue)return!1;var r=n.readTypeStg(ot.TRACK_PENDING),o=e.slice(0,i).filter((function(e){return!r.data.includes(e.$sequence_id)}));n.writeTypeStgSafe(ot.TRACK_PENDING,(function(e){return 0!==(null==o?void 0:o.length)&&(o.forEach((function(t){e.includes(t.$sequence_id)||e.push(t.$sequence_id)})),e.slice(-50))}));var a=e.filter((function(e){return o.every((function(t){return t.$sequence_id!==e.$sequence_id&&!r.data.includes(e.$sequence_id)}))}));if(o&&o.length>0){var s={request_id:Y(),body:o};t.push(s)}return[a,t]}));for(var r=this.readTypeStg(ot.TRACK);r.data.length>=Ft.config.max_batch_events&&1e3>this.consumeTrackCount;)this.consumeTrackCount++,this.pickEventQToReqQOriginal(4);null===(t=this.batchSend)||void 0===t||t.consumeStart(!1,this.logId)}},{key:"setCustomProperties",value:function(e){this.customPropertiesAttach="object"===n(e)?function(){return e}:e}}]),a}(Wt),hn={url:"",url_path:"",title:"",referrer:"",event_info:null,_storeDuration:0,_lastViewTime:0},pn="prev_visit_page";!function(e){e[e.DURATION=0]="DURATION",e[e.PAGE_VIEW=1]="PAGE_VIEW"}(Xt||(Xt={}));var vn=function(){function e(n,r){var o=this;i(this,e),this.trackTime=!1,this.inactivityCounter=0,this.inactivityTime=15,this.getAutoTrackParams=null,this.pageDuration=hn,this.trackDispatch=void 0,this.logger=new B({namespace:"page_visit"}),this.oTrack=null,this.oTrack=r;var a=Ft.config;this.trackDispatch=n||function(){},this.pageDuration=t(t({},hn),le(pn)),this.pageDuration._lastViewTime>0&&this.toTrackQueue(Xt.DURATION,this.pageDuration,!0),this.startCounter(),"auto"===a.pageview.track_pageview_type.toLocaleLowerCase()&&a.is_single_page_app&&it.push((function(e,t){t&&t.href===e.href||setTimeout((function(){o.trackPageView()}),a.pageview.delay)})),setTimeout((function(){o.trackPageView(a.pageview.is_trigger_pageload&&!a.pageview.track_ignore(location))}),a.pageview.delay),this.trackVersion(),this.trackPageLoad()}return o(e,[{key:"trackPageView",value:function(e,n){var i=t(t({},this.oTrack.detectSourceType()),n);void 0===e&&(e=!0),this.getAutoTrackParams&&E(this.getAutoTrackParams)&&(i=t(t({},ye(this.getAutoTrackParams())),i)),this.pageDuration&&this.toTrackQueue(Xt.DURATION,this.pageDuration,!1);var r=Y(6),o=Date.now(),a={url:window.location.href||"/",url_path:window.location.pathname||"/",title:Ft.config.pageview.url_alias[location.pathname||"/"]||document.title,referrer:it.getPrevUrl(),event_info:t(t({},i),{},{$visit_id:r,$visit_time:o}),_lastViewTime:de()};this.storeSession(a),!Ft.config.pageview.track_ignore(location)&&e&&this.toTrackQueue(Xt.PAGE_VIEW,t(t({},i),{},{$visit_id:r,$visit_time:o}))}},{key:"startCounter",value:function(){var e=this,t="hidden";this.startTime();var n=function(){document[t]?e.stopTime():e.startTime()};t in document?document.addEventListener("visibilitychange",n):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",n):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",n):(t="msHidden")in document?document.addEventListener("msvisibilitychange",n):"onfocusin"in document?(C(window,"focusin",(function(){e.startTime()})),C(window,"focusout",(function(){e.stopTime()}))):(C(window,"focus",(function(){e.startTime()})),C(window,"blur",(function(){e.stopTime()})),C(window,"pageshow",(function(){e.startTime()})),C(window,"pagehide",(function(){e.stopTime()})));var i=function(){e.inactivityTime>e.inactivityCounter||e.startTime(),e.inactivityCounter=0};C(window,"mousemove",i),C(window,"click",i),C(window,"keydown",i),C(window,"scroll",i),C(window,"beforeunload",(function(){e.stopTime()})),C(window,"unload",(function(){e.stopTime()})),setInterval((function(){e.inactivityCounter++,e.inactivityTime>e.inactivityCounter||e.stopTime()}),6e4)}},{key:"startTime",value:function(){this.trackTime||(this.trackTime=!0,this.pageDuration._lastViewTime=de()-this.pageDuration._storeDuration,this.pageDuration._storeDuration=0,this.storeSession({_storeDuration:this.pageDuration._storeDuration,_lastViewTime:this.pageDuration._lastViewTime}))}},{key:"stopTime",value:function(){this.trackTime&&(this.trackTime=!1,this.pageDuration._storeDuration=de()-this.pageDuration._lastViewTime,this.storeSession({_storeDuration:this.pageDuration._storeDuration}))}},{key:"setAutoTrackParam",value:function(e){var t=e;"object"===n(e)&&(t=function(){return e}),this.getAutoTrackParams=t}},{key:"getAutoTrackParam",value:function(){return this.getAutoTrackParams||function(){return{}}}},{key:"toTrackQueue",value:function(e,i,r){if(e===Xt.DURATION){var o=0;if(r||this.trackTime?o=0!==this.pageDuration._storeDuration?this.pageDuration._storeDuration:de()-this.pageDuration._lastViewTime:this.trackTime||(o=this.pageDuration._storeDuration),o>0&&""!==this.pageDuration.url&&Ft.config.is_track_visittime){var a=i||{},s=a.event_info,c=a.url,u=a.url_path,l=a.title,f=a.referrer;this.trackDispatch(t(t({},dt),{},{url:c,url_path:u,title:l,referrer:f,properties:t({duration:o},s)}))}return this.pageDuration=t({},hn),this.storeSession(null),!0}this.trackDispatch(t(t({},ft),{},{properties:t({},"object"===n(i)?i:null),is_first_day:zt.userInfo.isFirstDayFromCookies(),is_first_time:zt.userInfo.isFirstTime}))}},{key:"storeSession",value:function(e){if(null==e)return le(pn,null);this.pageDuration=t(t(t({},hn),this.pageDuration),e),this.pageDuration.referrer||(this.pageDuration.referrer=it.getPrevUrl()),le(pn,this.pageDuration)}},{key:"trackVersion",value:function(){var e=this,n=Pt(Ft.config.region.toLowerCase());Ee("".concat(n,"/api/getVersion"),{success:function(n){var i;if((null===(i=Ft.getPkgInfo())||void 0===i?void 0:i.version)!==n.version){var r=window,o=r.performance||r.webkitPerformance||r.msPerformance||r.mozPerformance;if(o.getEntries&&"function"==typeof o.getEntries){var a=o.getEntries().find((function(e){return e.name.includes("/otrack/")}));if(a&&a.name){var s,c=a.toJSON()||{},u={url:window.location.href||"/",url_path:window.location.pathname||"/",title:Ft.config.pageview.url_alias[location.pathname||"/"]||document.title,referrer:it.getPrevUrl(),properties:t({serverVersion:n.version,pkgVersion:null===(s=Ft.getPkgInfo())||void 0===s?void 0:s.version},c)};a&&e.trackDispatch(t(t({},pt),u))}}}}})}},{key:"trackPageLoad",value:function(){var e,i=this,r=function e(){var r=window,o=r.performance||r.webkitPerformance||r.msPerformance||r.mozPerformance,a=0,s=0;if(o&&o.timing){var c=o.timing;0===c.fetchStart||0===c.domContentLoadedEventEnd?K.error("performance 数据获取异常"):(a=Number(((a=c.domContentLoadedEventEnd-c.fetchStart)/1e3).toFixed(3)),o.getEntries&&"function"==typeof o.getEntries&&(o.getEntries().map((function(e){"transferSize"in e&&(s+=+e.transferSize)})),s=s>=0&&10737418240>s?Number((s/1024).toFixed(3)):-1))}else a=-1,K.info("浏览器不支持 performance");var u={$page_event_duration:a,$page_resource_size:s};i.trackDispatch(t(t({},ht),{},{properties:t({},"object"===n(u)?u:null)})),A(window,"load",e)};"complete"==(null===(e=document)||void 0===e?void 0:e.readyState)?r():C(window,"load",r)}}]),e}(),gn="1.6.3",mn=function(){function e(n){i(this,e),this.oTrack=null,this.store=null,this.conf=null,this.autoTrackEnabled=!1,this.regexList={};var r=t({},n);this.oTrack=r.oTrack,this.store=r.store,this.conf=Ft.config,this.conf.preset_properties||(this.conf.preset_properties={latest_utm:!0,latest_referrer_host:!1,latest_landing_page:!1})}return o(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};K.info("神策init初始化配置: ",e),void 0!==e.preset_properties&&(this.conf.preset_properties=t(t({},this.conf.preset_properties),e.preset_properties)),this.watchUTM(this.conf.preset_properties.latest_utm),void 0!==e.cross_subdomain&&(this.conf.is_cross_subdomain=e.cross_subdomain),void 0!==e.name&&(this.conf.namespace=e.name),void 0!==e.is_single_page&&(this.conf.is_single_page_app=e.is_single_page),void 0!==e.max_referrer_string_length&&(this.conf.max_referrer_string_length=e.max_referrer_string_length||200),e.debug_mode&&(this.conf.log_level="debug"),e.project&&(this.conf.project=e.project+""||"default")}},{key:"watchUTM",value:function(e){this.conf.pageview.watch_utm=!!e}},{key:"quick",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return this[e].apply(this,n)}},{key:"autoTrackWithoutProfile",value:function(e){this.autoTrack(t(t({},e),{},{not_set_profile:!0}))}},{key:"autoTrack",value:function(e){this.autoTrackEnabled=!0,this.conf.pageview.is_trigger_pageload=!0;var t=!0;e&&(t=!e.not_set_profile,delete e.not_set_profile),this.sendFirstProfile(this.setOnceProfile.bind(this),!0,t),e&&this.oTrack.setCustomProperties(e)}},{key:"autoTrackSinglePage",value:function(e){this.conf.is_single_page_app=!0;var t=!0;e&&(t=!e.not_set_profile,delete e.not_set_profile),this.sendFirstProfile(this.setOnceProfile.bind(this),!1,t),this.oTrack.trackPageView(!0,e)}},{key:"isReady",value:function(e){"function"==typeof e&&Ft.registerCallbacks(e)}},{key:"trackHeatMap",value:function(e,t,n){this.oTrack.heatmap?this.oTrack.heatmap.trackHeatMap(e,t,n):K.info("mini版jssdk不支持heatmap能力，若需要请使用完整版")}},{key:"trackAllHeatMap",value:function(e,t,n){this.oTrack.heatmap?this.oTrack.heatmap.trackAllHeatMap(e,t,n):K.info("mini版jssdk不支持heatmap能力，若需要请使用完整版")}},{key:"getPresetProperties",value:function(){var e,n,i,r=this.oTrack.getHeader(),o=this.detectSourceType(!1),a=this.getUtm(o);return t(t({},r),{},{$url:(null===(e=window)||void 0===e?void 0:e.location.href)||"/",$url_path:(null===(n=window)||void 0===n?void 0:n.location.pathname)||"/",$title:null===(i=document)||void 0===i?void 0:i.title},a)}},{key:"getAnonymousID",value:function(){var e=this.store.getIdentities();return e.$identity_anonymous_id||e.$identity_login_id||""}},{key:"identify",value:function(e){if(this.autoTrackEnabled)throw Error("identify方法调用必须放在开启autoTrack之前");var t=e+"";t.length>0||K.error("参数不能为空"),this.oTrack.setDeviceId(t),this.store.setIdentities({$identity_cookie_id:t})}},{key:"login",value:function(e,t){if(this.oTrack.getUserId())return K.error("已经登录过，不可重复登录"),!1;var n=e+"";n.length>0||K.error("参数不能为空"),this.trackSignup(n,"",{},t)}},{key:"logout",value:function(){var e=this.store.getIdentities().$identity_anonymous_id;this.oTrack.setUserId(""),this.store.setIdentities({$identity_login_id:e,$identity_anonymous_id:fe()})}},{key:"registerPage",value:function(e){this.oTrack.setAutoTrackParam((function(){return t({},e)}))}},{key:"clearPageRegister",value:function(e){if(I(e)){var t=this.oTrack.getAutoTrackParam()();e.forEach((function(e){e in t&&delete t[e]})),this.registerPage(t)}else!0===e&&this.oTrack.setAutoTrackParam({})}},{key:"register",value:function(e){this.store.setProps(e)}},{key:"registerOnce",value:function(e){this.store.setPropsOnce(e)}},{key:"clearAllRegister",value:function(e){this.store.clearAllProps(e)}},{key:"setProfile",value:function(e,n){var i=t(t({},vt),{},{properties:e});i.eventId=i.eventId+"profile_set",this.oTrack.track(i,n)}},{key:"setOnceProfile",value:function(e,n){var i=t(t({},vt),{},{properties:e});i.eventId=i.eventId+"profile_set_once",this.oTrack.track(i,n)}},{key:"sendFirstProfile",value:function(e,n,i){if(zt.userInfo.isFirstTime&&i){var r=this.detectSourceType(!0),o=this.getUtm(r);e(t(t({},o),{},{$first_referrer:n?o.$first_referrer:o.$first_referrer.slice(0,this.conf.max_referrer_string_length)}))}}},{key:"getUtm",value:function(e){var t={};if(!this.conf.pageview.watch_utm)return t;if(!function(){var e,t,n=me(null===(e=location)||void 0===e?void 0:e.href),i=me(null===(t=document)||void 0===t?void 0:t.referrer);if(n&&i){var r=n.host.split("."),o=i.host.split("."),a=Math.min(r.length,o.length)-1;if(r.slice(-a).join(".")===o.slice(-a).join("."))return!0}return!1}()){if(gt.utm.forEach((function(e){t["$"+e]=ge(e)||""})),zt.userInfo.isFirstTime&&t.$utm_source)return t.$source_type="utm",t.$first_traffic_source_type="付费广告流量",e.$latest_search_keyword&&(t.$first_search_keyword=e.$latest_search_keyword),t;gt.utm.forEach((function(e){t["$latest_"+e]=ge(e)||""})),t.$utm_source&&(t.$source_type="utm",t.$latest_traffic_source_type="付费广告流量")}return t}},{key:"detectSourceType",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={},i=null===(e=window)||void 0===e?void 0:e.location;if(i){var r;n.$latest_referrer=(null===(r=document)||void 0===r?void 0:r.referrer)||"",n.$latest_traffic_source_type=n.$latest_referrer?"引荐流量":"直接流量",n.$latest_referrer_host="";var o=me(n.$latest_referrer);o?(n.$latest_referrer="".concat(o.schema).concat(o.host).concat(o.path),n.$latest_referrer_host=o.host||"",n.$latest_search_keyword="未取到值"):n.$latest_search_keyword="未取到值_直接打开",this.conf.preset_properties.latest_landing_page&&(n.$latest_landing_page=i.href||"");for(var a=0;gt.social.length>a;a++){var s=gt.social[a],c=this.regexList[s];if(c||(c=this.regexList[s]=RegExp("\\b".concat(s,"\\b"),"i")),c.test(n.$latest_referrer_host)){n.$source_type="social",n.$latest_traffic_source_type="社交网站流量";break}}for(var u=0;gt.search.length>u;u++){var l=gt.search[u],f=this.regexList[l];if(f||(f=this.regexList[l]=RegExp("\\b".concat(l,"\\b"),"i")),f.test(n.$latest_referrer_host)){n.$source_type="search",n.$latest_traffic_source_type="自然搜索流量";for(var d=Object.keys(gt.keyword),h=0;d.length>h;h++){var p=RegExp("\\b".concat(d[h],"\\b"),"i");if(p.test(l)){var v=gt.keyword[d[h]];if(n.$latest_search_keyword="",o)for(var g=0;v.length>g&&(n.$latest_search_keyword=o.query[v[g]]||"",!n.$latest_search_keyword);g++);n.$latest_search_keyword||(n.$latest_search_keyword=n.$latest_referrer?"未取到值":"未取到值_直接打开");break}}break}}this.conf.preset_properties.latest_referrer_host||delete n.$latest_referrer_host}if(t&&zt.userInfo.isFirstTime){var m,y;n.$first_visit_time=Date.now(),n.$first_referrer=(null===(m=document)||void 0===m?void 0:m.referrer)||"";var _=me(n.$first_referrer);_&&(n.$first_referrer_host=_.host||"");var w=navigator||{};n.$first_browser_language=w.language||w.userLanguage||"",n.$first_browser_charset=(null===(y=document)||void 0===y?void 0:y.charset.toUpperCase())||""}return n}},{key:"unsetProfile",value:function(e,n){if("string"==typeof e)e=[e];else if(!I(e))return void K.error("参数类型不合法");var i={};e.forEach((function(e){return i[e]=!0}));var r=t(t({},vt),{},{properties:i});r.eventId=r.eventId+"profile_unset",this.oTrack.track(r,n)}},{key:"deleteProfile",value:function(e){var n=t({},vt);n.eventId=n.eventId+"profile_delete",this.oTrack.track(n,e),this.oTrack.setUserId("")}},{key:"incrementProfile",value:function(e,n){"string"==typeof e&&(e=a({},e,1));var i={};Object.keys(e).forEach((function(t){return i[t]=Number(e[t])}));var r=t(t({},vt),{},{properties:i});r.eventId=r.eventId+"profile_increment",this.oTrack.track(r,n)}},{key:"appendProfile",value:function(e,n){var i={},r=!0;if(Object.keys(e).forEach((function(t){i[t]="string"==typeof e[t]?[e[t]]:e[t],r=!1})),!r){var o=t(t({},vt),{},{properties:i});o.eventId=o.eventId+"profile_append",this.oTrack.track(o,n)}}},{key:"track",value:function(e,n,i){var r=this.oTrack.tracker;if("string"!=typeof e)return r.track.apply(r,arguments);var o={},a=n||{};return o.eventId=a.eventId?a.eventId+"":e,o.eventGroup=a.eventGroup?a.eventGroup+"":"$track_sa",o.properties=t({},n),r.track.call(r,o,i)}},{key:"trackSignup",value:function(e,n,i,r){"string"!=typeof e&&(e+=""),this.oTrack.setUserId(e);var o=t(t({},i),{},{original_id:this.getAnonymousID(),distinct_id:e}),a=t(t({},vt),{},{properties:o});a.eventId=a.eventId+(n||"signup"),this.oTrack.track(a,r);var s=this.store.getIdentities();this.store.setIdentities({$identity_login_id:e,$identity_anonymous_id:s.$identity_login_id})}},{key:"setItem",value:function(e,n,i){var r=t(t({},vt),{},{item_type:e,item_id:n,properties:t({},i)});r.eventId=r.eventId+"item_set",this.oTrack.track(r)}},{key:"deleteItem",value:function(e,n){var i=t(t({},vt),{},{item_type:e,item_id:n});i.eventId=i.eventId+"item_delete",this.oTrack.track(i)}},{key:"trackLink",value:function(e,t,n){this.oTrack.heatmap?this.oTrack.heatmap.trackLink(e,t,n):K.info("mini版jssdk不支持heatmap能力，若需要请使用完整版")}},{key:"getAppStatus",value:function(){try{var e,t=(null===(e=window)||void 0===e?void 0:e.App_AutoEvent_Js_Bridge)||{},n=t.call_app&&t.call_app();if(n){var i=JSON.parse(n);i.is_login?(this.login(i.distinct_id),i.is_login_id=!0):i.is_login_id=!1,delete i.is_login,delete i.distinct_id,"Android"===i.type&&zt.userInfo.setAppVersion(i.android_version);var r={};Object.keys(i).forEach((function(e){r["$".concat(e)]=i[e],"brand"===e&&(r.$manufacturer=i[e],delete r.$brand)}));try{var o,a=null===(o=navigator)||void 0===o?void 0:o.userAgent.match(/(\(.+?\))/);if(a){var s=a[0].match(/([\.\d\_\-]+)/)||[];r.$os_version=s[0]||""}}catch(e){r.$os_version=""}return r}}catch(e){console.error(e)}return{}}},{key:"uuid",value:function(){var e=Te();return e}},{key:"getDataSequenceId",value:function(){return"".concat(this.oTrack.getDeviceId(),"_").concat(Date.now())}},{key:"bind",value:function(){K.info("bind方法暂未实现")}},{key:"unbind",value:function(){K.info("unbind方法暂未实现")}},{key:"loginWithKey",value:function(){K.info("loginWithKey方法暂未实现")}},{key:"use",value:function(e,t){K.info("use方法暂未实现")}}]),e}(),yn="otrack_jssdk_session",_n=function(){function e(n){i(this,e),this.oTrack=null,this.state={props:{},identities:{$identity_cookie_id:"",$identity_anonymous_id:"",$identity_login_id:""},lib:{$lib:"js",$lib_method:"code",$lib_version:"1.24.6"}},this.sessionState={};var r=t({},n);void 0!==r.oTrack&&(this.oTrack=r.oTrack)}return o(e,[{key:"init",value:function(){this.initSessionState(),this.initState(),this.state.h5app=this.oTrack.getAppStatus();var e=t({},this.state.identities);if(!e.$identity_cookie_id){var n=this.oTrack.getDeviceId();n||(n=fe(),this.oTrack.setDeviceId(n)),e.$identity_cookie_id=n,e.$identity_anonymous_id=e.$identity_cookie_id,e.$identity_login_id=e.$identity_cookie_id}e.$identity_anonymous_id||(e.$identity_anonymous_id=fe()),e.$identity_login_id||(e.$identity_login_id=e.$identity_anonymous_id),this.state.identities=e,this.oTrack.setCustomHead(this.state)}},{key:"initState",value:function(){var e=this.oTrack.getCustomHead();this.state=t(t({},this.state),e)}},{key:"getIdentities",value:function(){return this.initState(),this.state.identities}},{key:"setIdentities",value:function(e){var n=1>=arguments.length||void 0===arguments[1]||arguments[1];this.initState(),this.state.identities=n?t(t({},this.state.identities),e):t(t({},e),this.state.identities),this.oTrack.setCustomHead(this.state)}},{key:"getProps",value:function(){return this.initState(),this.state.props}},{key:"setProps",value:function(e){var n=1>=arguments.length||void 0===arguments[1]||arguments[1];this.initState(),this.state.props=n?t(t({},this.state.props),e):t(t({},e),this.state.props),this.oTrack.setCustomHead(this.state)}},{key:"setPropsOnce",value:function(e){var t=this;this.initState(),Object.keys(e).forEach((function(n){n in t.state.props||(t.state.props[n]=e[n])})),this.oTrack.setCustomHead(this.state)}},{key:"initSessionState",value:function(){var e;try{e=ie(yt(ae(yn))||"null")}catch(e){K.error("cookies otrack_jssdk_session 获取失败")}e&&(this.sessionState=e)}},{key:"sessionSave",value:function(){re(yn,mt(ne(this.sessionState)),0,{cross_subdomain:Ft.config.is_cross_subdomain})}},{key:"getSessionProps",value:function(){return this.sessionState}},{key:"setSessionProps",value:function(e){this.sessionState=t(t({},this.sessionState),e),this.sessionSave()}},{key:"clearAllProps",value:function(e){var t=this;this.sessionState={},this.sessionSave(),e&&I(e)?e.forEach((function(e){e in t.state.props&&delete t.state.props[e]})):this.state.props={},this.oTrack.setCustomHead(this.state)}},{key:"getDistinctId",value:function(){return this.oTrack.getUserId()||this.oTrack.getDeviceId()}},{key:"getFirstId",value:function(){return this.oTrack.getDeviceId()}},{key:"getOriginDistinctId",value:function(){return this.oTrack.getUserId()||this.getIdentities().$identity_cookie_id}},{key:"getOriginUnionId",value:function(){var e={},t=this.getOriginDistinctId(),n=this.oTrack.getDeviceId();return t?(e.login_id=t,e.anonymous_id=n):e.anonymous_id=n,e}},{key:"getUnionId",value:function(){return this.getOriginUnionId()}}]),e}();new Promise((function(e){if(!(null==Array?void 0:Array.prototype.includes)||!(null==Object?void 0:Object.keys)){var t=document.createElement("script");t.onload=function(){e(!0)},document.head.appendChild(t),t.setAttribute("async","async"),t.setAttribute("src",(n="polyfill.umd.min.js",o={domestic:"".concat(ut.DOMESTIC,"/").concat(ut.FILES_COMMON,"/").concat(n),foreign:"".concat(ut.FOREIGN,"/").concat(ut.FILES_COMMON,"/").concat(n),intranet:"".concat(ut.INTRANET,"/").concat(ut.FILES_COMMON,"/").concat(n)},a=new Ne((r=(null===(i=location)||void 0===i?void 0:i.hostname)||"",!!(/\.example$/.test(r)||"localhost"===r||/\.wanyol\.com$/.test(r)||-1!==r.indexOf("test")||-1!==r.indexOf("dev")||/^\d+(?:.\d+){3}$/.test(r)))),"zh-CN"===navigator.language?a.isInCloud()?o.intranet:o.domestic:a.isInCloud()?o.intranet:o.foreign))}var n,i,r,o,a})),Ft.setPkgInfo({name:"@oplus/obus-track-sdk",version:gn});var wn=["track","startEvent","stopEvent","flush","setCustomProperties"],kn=["setCustomHead","getCustomHead","getDeviceId","setDeviceId","setAppVersion","getAppVersion","setUserId","getUserId","setCustomClientId","getCustomClientId","isFirstDayFromCookies","setIsWebview","getIsWebview"];function bn(e){var t=this;if(e){for(var n=e.split("."),i=n[n.length-1],r=0;n.length-1>r&&null!=(t=t[n[r]]);r++);if(null!=t){if(t&&"function"==typeof t[i]){for(var o=arguments.length,a=Array(o>1?o-1:0),s=1;o>s;s++)a[s-1]=arguments[s];return t[i].apply(t,a)}return t[i]}}else K.error("".concat(e," 不能为空"))}var Tn=function(){function e(t){var n=this;i(this,e),this.trackEvent=void 0,this.sensorsStore=void 0,this.dispatch=function(e){Ft.config.sdk_auto_track&&n.trackEvent.track(e)};var r=window;if(r.otrack)throw Error("oTrack has been instanced");r.OTrack=r.otrack=this,Ft.init(t,this);var o=this.trackEvent=new dn({oTrack:this});kn.forEach((function(e){n[e]=function(){return bn.apply(zt.userInfo,[e].concat(Array.prototype.slice.call(arguments)))}})),wn.forEach((function(e){n[e]=function(){return bn.apply(o,[e].concat(Array.prototype.slice.call(arguments)))}}));var a=this.sensorsStore=new _n({oTrack:this}),s=new mn({oTrack:this,store:a});Object.getOwnPropertyNames(mn.prototype).filter((function(e){return"constructor"!==e})).forEach((function(e){n[e]=function(){return bn.apply(s,[e].concat(Array.prototype.slice.call(arguments)))}})),this.getHeader=function(){return bn.apply(o,["batchSend.reportHeader.getHeader"].concat(Array.prototype.slice.call(arguments)))},this.updateCloudConfig=function(e){return bn.call(o,"cloudAppConfig.refresh",!0,(function(){(null==e||e)&&window.location.reload()}))};var c=new vn(this.dispatch,this);this.setAutoTrackParam=c.setAutoTrackParam.bind(c),this.getAutoTrackParam=c.getAutoTrackParam.bind(c),this.trackPageView=c.trackPageView.bind(c),this.sensorsStore.init(),"function"==typeof t.on_created&&t.on_created.call(this,{oTrack:this,options:t})}return o(e,[{key:"options",get:function(){return Ft.config}},{key:"store",get:function(){return this.sensorsStore}},{key:"tracker",get:function(){return this.trackEvent}}],[{key:"VERSION",get:function(){return gn}}]),e}();return Tn.CLOUD_VERSION=Ut.VERSION,Tn}));
